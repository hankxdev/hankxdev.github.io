<!DOCTYPE html>
<html lang="en">





<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="description" content="Full Stack Engineer,  Web Extension developer, Body Builder.">
  <meta name="keywords" content="Hank, web extension, Chrome Extension, Firefox Addon, Vue, Golang, Frontend, Mendix, and Low Code">
  <meta name="author" content="Hank&#39;s Personal Blog">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="theme-color" content="#f5f5f5">

  <!-- Twitter Tags -->
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Hank&#39;s Personal Blog">
  <meta name="twitter:description" content="Full Stack Engineer,  Web Extension developer, Body Builder.">
  
    <meta property="twitter:image" content="https://momane.com/img/leonids-logo.png">
  

  <!-- Open Graph Tags -->
  <meta property="og:type" content="blog">
  <meta property="og:url" content="https://momane.com/">
  <meta property="og:title" content="Hank&#39;s Personal Blog">
  <meta property="og:description" content="Full Stack Engineer,  Web Extension developer, Body Builder.">
  
    <meta property="og:image" content="https://momane.com/img/leonids-logo.png">
  
  <title>Hank's Personal Blog</title>

  <!-- CSS files -->
  <link rel="stylesheet" href="https://momane.com/css/font-awesome.min.css">
  <link rel="stylesheet" href="https://momane.com/css/main.css">

  <link rel="canonical" href="https://momane.com/">
  <link rel="alternate" type="application/rss+xml" title="Hank&#39;s Personal Blog" href="https://momane.com/feed.xml" />

  <!-- Icons -->
  <!-- 16x16 -->
  <link rel="shortcut icon" href="https://momane.com/favicon.ico">
  <!-- 32x32 -->
  <link rel="shortcut icon" href="https://momane.com/favicon.png">
</head>


<body>
  <div class="row">
    <div class="col s12 m3">
      <div class="table cover">
        

<div class="cover-card table-cell table-middle">
  
  <a href="https://momane.com/">
    <img src="https://momane.com/img/avatar.jpeg" alt="" class="avatar">
  </a>
  
  <a href="https://momane.com/" class="author_name">Hank X</a>
  <span class="author_job">Full Stack Engineer</span>
  <span class="author_bio mbm">Run, Build, Enjoy</span>
  <nav class="nav">
    <ul class="nav-list">
      <li class="nav-item">
        <a href="https://momane.com/">home</a>
      </li>
      
        
          <li class="nav-item">
            <a href="https://momane.com/archive/">Archive</a>
          </li>
        
      
        
      
        
          <li class="nav-item">
            <a href="https://momane.com/categories/">Categories</a>
          </li>
        
      
        
      
        
      
        
          <li class="nav-item">
            <a href="https://momane.com/resume/">Resume</a>
          </li>
        
      
        
          <li class="nav-item">
            <a href="https://momane.com/tags/">Tags</a>
          </li>
        
      
        
      
    </ul>
  </nav>
  <script type="text/javascript">
  // based on http://stackoverflow.com/a/10300743/280842
  function gen_mail_to_link(hs, subject) {
    var lhs,rhs;
    var p = hs.split('@');
    lhs = p[0];
    rhs = p[1];
    document.write("<a class=\"social-link-item\" target=\"_blank\" href=\"mailto");
    document.write(":" + lhs + "@");
    document.write(rhs + "?subject=" + subject + "\"><i class=\"fa fa-fw fa-envelope\"></i><\/a>");
  }
</script>
<div class="social-links">
  <ul>
    
      <li>
      <script>gen_mail_to_link('yrstyh@gmail.com', 'Hello from website');</script>
      </li>
    
    <li><a href="http://twitter.com/hankmomane" class="social-link-item" target="_blank"><i class="fa fa-fw fa-twitter"></i></a></li>
    
    
    
    <li><a href="skype:yrstyh" class="social-link-item" target="_blank"><i class="fa fa-fw fa-skype"></i></a></li>
    
    
    
    <li><a href="http://github.com/hankxdev" class="social-link-item" target="_blank"><i class="fa fa-fw fa-github"></i></a></li>
    
    <li><a href="http://stackoverflow.com/users/2095705/hank-x" class="social-link-item" target="_blank"><i class="fa fa-fw fa-stack-overflow"></i></a></li>
    
    
    
    
    
    
    
    
    
    
    
    
    
  </ul>
</div>

</div>

      </div>
    </div>
    <div class="col s12 m9">
      <div class="post-listing">
        
<section class="post">
  <header class="post-header">
    <p class="post-meta">
      <span class="post-date">
        1 AUG 2023
      </span>
      
      •
      
        <a class="post-cat" href="https://momane.com/categories/#programming">programming</a>
        
      
      
    </p>
    <h2>
      <a href="https://momane.com/articles/2023-08/mendix-improve-modal-popup-close-performance" class="post-title" title="Fixing the Close Action for a Modal popup in Mendix">Fixing the Close Action for a Modal popup in Mendix</a>
      
    </h2>

    

    </header>

    
    <div class="post-description">
      <p>
        <p>Our tester engineer recently reported an issue where in a Mendix app,  it takes more than 3 seconds to close a popup after clicking the close button.</p>

<p>We looked closely at the log and found that it always does some rollback and fetching before actually closing the modal.</p>

<p><img src="../img/rollback_in_log.png" alt="rollback in log" width="550px" /></p>

<p>We found that the default Close action for the modal is Cancel, which means cancel changes that are not committed in Mendix. This explains why it triggers rollback and retrieve before closing, even though no changes have been made.</p>

<p>To fix this, you can change the Close action to <em>Close Page</em>.</p>

<p>However, there is no Close page in the list. There are some options that are bound to other buttons in the modal.</p>

<p><img src="../img/modal_close_actoins.png" alt="modal_close_actoins" width="550px" /></p>

<p>So you have to add a button in the modal, bind close page action to the button, and change the Close action of the model to the button.</p>

<p><img src="../img/modal_button_close_page.png" alt="modal_button_close_page" width="550px" /></p>

<p>Sometimes you don’t need this extra button shown in the modal; you can just give it a hidden style, like adding <code class="language-plaintext highlighter-rouge">display:none</code> style in its appearance tab.</p>

<p>—EOF—</p>

      </p>
    </div>
    

    

</section>

<section class="post">
  <header class="post-header">
    <p class="post-meta">
      <span class="post-date">
        28 OCT 2022
      </span>
      
      •
      
        <a class="post-cat" href="https://momane.com/categories/#programming">programming</a>
        
      
      
    </p>
    <h2>
      <a href="https://momane.com/articles/2022-10/mendix-how-to-call-microflow-in-javaaction-and-use-its-return-value-copy" class="post-title" title="Mendix: How to call Microflow in Java Action and use its return value">Mendix: How to call Microflow in Java Action and use its return value</a>
      
    </h2>

    

    </header>

    
    <div class="post-description">
      <p>
        <p>After you dive into Mendix for a longer time, you would find yourself writing java code now and then. Don’t worry, good news is that you don’t need to write a lot of java code, Mendix is Low Code anyway.</p>

<p>In Mendix, java code is been called Java Action.</p>

<p>And you will also find you have to call Microflow in your java code. And in the latest version, approx Mendix 8.1, calling a Microflow can be in this way:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">com</span><span class="o">.</span><span class="na">mendix</span><span class="o">.</span><span class="na">core</span><span class="o">.</span><span class="na">Core</span><span class="o">.</span><span class="na">microflowCall</span><span class="o">(</span><span class="s">"YourModule.SUB_ShowMessage"</span><span class="o">)</span>
<span class="o">.</span><span class="na">inTransaction</span><span class="o">(</span><span class="kc">true</span><span class="o">)</span>
<span class="o">.</span><span class="na">withParam</span><span class="o">(</span><span class="s">"Name"</span><span class="o">,</span> <span class="s">"Hank"</span><span class="o">)</span>
<span class="o">.</span><span class="na">withParam</span><span class="o">(</span><span class="s">"Message"</span><span class="o">,</span> <span class="s">"Just another developer"</span><span class="o">)</span>
<span class="o">.</span><span class="na">execute</span><span class="o">(</span><span class="k">this</span><span class="o">.</span><span class="na">getContext</span><span class="o">());</span>
</code></pre></div></div>

<p>This will call your Microflow <code class="language-plaintext highlighter-rouge">SUB_ShowMessage</code> in your <code class="language-plaintext highlighter-rouge">YourModule</code> module, passing <strong>Name</strong> and <strong>Message</strong> to it.</p>

<p>Sometimes if your Microflow has too many parameters, clearly chaining too many <strong>withParam</strong> is not a proper way. You can use <strong>HashMap</strong></p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">java</span><span class="o">.</span><span class="na">util</span><span class="o">.</span><span class="na">Map</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span> <span class="nc">Object</span><span class="o">&gt;</span> <span class="n">params</span> <span class="o">=</span> <span class="k">new</span> <span class="n">java</span><span class="o">.</span><span class="na">util</span><span class="o">.</span><span class="na">HashMap</span><span class="o">&lt;&gt;();</span>
<span class="n">params</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"Name"</span><span class="o">,</span> <span class="s">"Hank"</span><span class="o">);</span>
<span class="n">params</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"Message"</span><span class="o">,</span> <span class="s">"Just another developer"</span><span class="o">);</span>
<span class="n">params</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"note"</span><span class="o">,</span> <span class="s">"This seems also a lot of code"</span><span class="o">)</span>
<span class="n">com</span><span class="o">.</span><span class="na">mendix</span><span class="o">.</span><span class="na">core</span><span class="o">.</span><span class="na">Core</span><span class="o">.</span><span class="na">microflowCall</span><span class="o">(</span><span class="s">"YourModule.SUB_ShowMessage"</span><span class="o">)</span>
<span class="o">.</span><span class="na">inTransaction</span><span class="o">(</span><span class="kc">true</span><span class="o">)</span>
<span class="o">.</span><span class="na">withParams</span><span class="o">(</span><span class="n">params</span><span class="o">)</span>
<span class="o">.</span><span class="na">execute</span><span class="o">(</span><span class="k">this</span><span class="o">.</span><span class="na">getContext</span><span class="o">());</span>
</code></pre></div></div>

<p>You can see there is no return value in the Microflow or you don’t want/need to use the return value of it.</p>

<p>But what about you want to use it?</p>

<p>If your Microflow returns a simple value, like <em>String</em>, <em>Long/Integer</em>, <em>Boolean</em>, then it’s easy, just assign it to your Java variable:</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">Boolean</span> <span class="n">mfValue</span> <span class="o">=</span> <span class="n">com</span><span class="o">.</span><span class="na">mendix</span><span class="o">.</span><span class="na">core</span><span class="o">.</span><span class="na">Core</span><span class="o">.</span><span class="na">microflowCall</span><span class="o">(</span><span class="s">"YourModule.SUB_ShowMessageWithReturnValue"</span><span class="o">)</span>
<span class="o">.</span><span class="na">inTransaction</span><span class="o">(</span><span class="kc">true</span><span class="o">)</span>
<span class="o">.</span><span class="na">withParam</span><span class="o">(</span><span class="s">"Name"</span><span class="o">,</span> <span class="s">"Hank"</span><span class="o">)</span>
<span class="o">.</span><span class="na">withParam</span><span class="o">(</span><span class="s">"Message"</span><span class="o">,</span> <span class="s">"Just another developer"</span><span class="o">)</span>
<span class="o">.</span><span class="na">execute</span><span class="o">(</span><span class="k">this</span><span class="o">.</span><span class="na">getContext</span><span class="o">());</span>

<span class="c1">// then you can use the mfValue</span>
</code></pre></div></div>

<p>Well, this seems easy, what if the Microflow returns an object?</p>

<p>When a Microflow returns an Object, it will lose its Entity definition and returns an interface  <em>*IMendixObject</em>. You can not use it without init it with the corresponding Entity. Let’s say, it returns a <em>*System.User</em> entity, then you will do this to use it:</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// returns IMendixObject </span>
<span class="nc">IMendixObject</span> <span class="n">mendixObj</span> <span class="o">=</span> <span class="n">com</span><span class="o">.</span><span class="na">mendix</span><span class="o">.</span><span class="na">core</span><span class="o">.</span><span class="na">Core</span><span class="o">.</span><span class="na">microflowCall</span><span class="o">(</span><span class="s">"YourModule.SUB_ShowMessageWithReturnValue"</span><span class="o">)</span>
<span class="o">.</span><span class="na">inTransaction</span><span class="o">(</span><span class="kc">true</span><span class="o">)</span>
<span class="o">.</span><span class="na">withParam</span><span class="o">(</span><span class="s">"Name"</span><span class="o">,</span> <span class="s">"Hank"</span><span class="o">)</span>
<span class="o">.</span><span class="na">withParam</span><span class="o">(</span><span class="s">"Message"</span><span class="o">,</span> <span class="s">"Just another developer"</span><span class="o">)</span>
<span class="o">.</span><span class="na">execute</span><span class="o">(</span><span class="k">this</span><span class="o">.</span><span class="na">getContext</span><span class="o">());</span>

<span class="c1">// init with Entity's init function </span>
  <span class="kd">final</span> <span class="nc">User</span> <span class="n">user</span> <span class="o">=</span> <span class="nc">User</span><span class="o">.</span><span class="na">initialize</span><span class="o">(</span><span class="k">this</span><span class="o">.</span><span class="na">getContext</span><span class="o">(),</span> <span class="n">mendixObj</span><span class="o">);</span>
</code></pre></div></div>

<p>—EOF—</p>

      </p>
    </div>
    

    

</section>

<section class="post">
  <header class="post-header">
    <p class="post-meta">
      <span class="post-date">
        28 JUL 2022
      </span>
      
      •
      
        <a class="post-cat" href="https://momane.com/categories/#programming">programming</a>
        
      
      
    </p>
    <h2>
      <a href="https://momane.com/articles/2022-07/how-to-detect-if-an-element-is-visible" class="post-title" title="JavaScript :How to detect if an element is visible">JavaScript :How to detect if an element is visible</a>
      
    </h2>

    

    </header>

    
    <div class="post-description">
      <p>
        <p>There are many ways to detect if an element is visible on page. like</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">element</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">display</span> <span class="o">!==</span> <span class="nx">none</span> <span class="o">&amp;&amp;</span> <span class="nx">element</span><span class="p">.</span><span class="nx">visibility</span> <span class="o">!==</span> <span class="nx">hidden</span>
</code></pre></div></div>

<p>And what if you want to detect if an elemtn is in current viewport?</p>

<p>Easy, right? You just need to use <code class="language-plaintext highlighter-rouge">getBoundingClientRect</code>,  check if it’s top and bottom are all in viewport:</p>
<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">const</span> <span class="nx">position</span> <span class="o">=</span> <span class="nx">element</span><span class="p">.</span><span class="nx">getBoundingClientRect</span><span class="p">();</span>

<span class="k">if</span><span class="p">(</span><span class="nx">position</span><span class="p">.</span><span class="nx">top</span> <span class="o">&gt;=</span> <span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="nx">position</span><span class="p">.</span><span class="nx">bottom</span> <span class="o">&lt;=</span> <span class="nb">window</span><span class="p">.</span><span class="nx">innerHeight</span><span class="p">)</span> <span class="p">{</span>
  <span class="c1">//it's in</span>
<span class="p">}</span>

</code></pre></div></div>

<p>Or, there is another way, with <code class="language-plaintext highlighter-rouge">IntersectionObserver</code> [https://developer.mozilla.org/en-US/docs/Web/API/Intersection_Observer_API]. It can observe a target element and you can do something while the target elment enters or leaves viewport.</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">observer</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">IntersectionObserver</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">entries</span><span class="p">)</span> <span class="p">{</span>
	<span class="k">if</span><span class="p">(</span><span class="nx">entries</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">isIntersecting</span> <span class="o">===</span> <span class="kc">true</span><span class="p">)</span>
		<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">Element has just become visible in screen</span><span class="dl">'</span><span class="p">);</span>
<span class="p">},</span> <span class="p">{</span> <span class="na">threshold</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="p">});</span>

<span class="nx">observer</span><span class="p">.</span><span class="nx">observe</span><span class="p">(</span><span class="nx">element</span><span class="p">);</span>
</code></pre></div></div>

<p>Note that the <code class="language-plaintext highlighter-rouge">threshold</code>, it is a number between 0 and 1, that represents the viewable area of the target element in the screen. For example, 0 represents no area of element is visible. A value of 0.10 represents about 10% area is viewable in screen. Value of 1 means element is fully viewable in screen.
You can even specify multiple thresholds.</p>

<p>Now think about another scenario, what if an element is visible, but it’s parent is not visible? like:</p>
<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"parent"</span> <span class="na">style=</span><span class="s">"disply: none"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"child"</span> <span class="na">style=</span><span class="s">"display: block"</span><span class="nt">&gt;</span>
    I'm not visible
  <span class="nt">&lt;/div&gt;</span>
<span class="nt">&lt;/div&gt;</span>
</code></pre></div></div>

<p>If you run <code class="language-plaintext highlighter-rouge">document.querySelector('child').style.display === 'block'</code>, you will get a <strong>true</strong>.</p>

<p>How to fix this?</p>

<p>Well we can use <code class="language-plaintext highlighter-rouge">offsetParent</code>. The HTMLElement.offsetParent read-only property returns a reference to the element which is the closest (nearest in the containment hierarchy) positioned ancestor element.</p>

<p>so if <code class="language-plaintext highlighter-rouge">elment.offsetParent === null</code>, then we can tell that the <code class="language-plaintext highlighter-rouge">element</code> is not visible.</p>


      </p>
    </div>
    

    

</section>

<section class="post">
  <header class="post-header">
    <p class="post-meta">
      <span class="post-date">
        14 SEP 2021
      </span>
      
      •
      
        <a class="post-cat" href="https://momane.com/categories/#programming">programming</a>
        
        <span>/</span>
        
      
        <a class="post-cat" href="https://momane.com/categories/#tips">tips</a>
        
      
      
    </p>
    <h2>
      <a href="https://momane.com/2021-09-14-enable-https-and-domain-on-local" class="post-title" title="Enable HTTPS on local, even with a customizable domain">Enable HTTPS on local, even with a customizable domain</a>
      
    </h2>

    

    </header>

    
    <div class="post-description">
      <p>
        <p>Normally, when you’re debugging your web app on local, you can access it with either <code class="language-plaintext highlighter-rouge">http://localhost:PORT</code> or <code class="language-plaintext highlighter-rouge">http://127.0.0.1:POST</code>.</p>

<p>The <code class="language-plaintext highlighter-rouge">POST</code> might be <code class="language-plaintext highlighter-rouge">8080</code> or <code class="language-plaintext highlighter-rouge">3000</code> or what’s ever.</p>

<p>But sometimes you might need to access your local web app with <code class="language-plaintext highlighter-rouge">https</code>, like <code class="language-plaintext highlighter-rouge">https://localhost:8080</code>. So you search online
with <code class="language-plaintext highlighter-rouge">local https</code>, tons of posts/tutorials teach you how to generate self-signed SSL certificate and assign to your localhost.</p>

<p>As an app developer, you might feel it’s too complicated and don’t want to spend half an hour on it.</p>

<p>So here I found the easiest way to achieve this with just one small tool and 1 line command, without changing anything in your actual app.</p>

<p>This tool is (<strong>local-ssl-proxy</strong>)[https://www.npmjs.com/package/local-ssl-proxy] , it is an open sourced npm package. so you can just install it by running</p>
<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>npm <span class="nb">install</span> <span class="nt">-g</span> local-ssl-proxy
</code></pre></div></div>
<p>Then you can just access your local web app with this command(let’s assume the app is running on 8080 port):</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>local-ssl-proxy -s 8081 -t 8080
</code></pre></div></div>

<p>In this way, your web app’s url will be <code class="language-plaintext highlighter-rouge">https://localhost:8081</code>. And you can still access your app from the original http url and port.</p>

<p>The <strong>-s</strong> is the port that the app will be proxies to, the <strong>8080</strong> is the actual port your app running on.</p>

<h3 id="whats-more">what’s more?</h3>

<p>If you don’t like to use the localhost, or you have to assign as domain to your local app. you can simply make it with 2 more steps.</p>

<ul>
  <li>add a line in your computer’s <strong>hosts</strong> file.
    <ul>
      <li>if you are on Windows, the hosts file’s path is <code class="language-plaintext highlighter-rouge">c:\windows\system32\drivers\etc\hosts</code></li>
      <li>on Mac and Linux the path simply is <code class="language-plaintext highlighter-rouge">/etc/hosts</code></li>
      <li>you need Admin/root privilege to modify it</li>
    </ul>

    <p>The line would be</p>
    <div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>127.0.0.1 YOUR_DOMAIN
</code></pre></div>    </div>
    <p>The <code class="language-plaintext highlighter-rouge">YOUR_DOMAIN</code> can be anything, you don’t even register the domain, because it only works on your computer.</p>

    <p>But don’t use some famous one like youtube.com or google.com, some browser would block it.</p>

    <p>Let’s say we use the <code class="language-plaintext highlighter-rouge">hank.momane</code> in below example.</p>
  </li>
  <li>Then run the proxy like this:
    <div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>local-ssl-proxy <span class="nt">-s</span> 443 <span class="nt">-t</span> 8080 <span class="nt">-n</span> hank.momane
</code></pre></div>    </div>
  </li>
</ul>

<p>So by using the SSL port <strong>443</strong> and an extra parameter <strong>-n</strong>, now you can access your
app via <code class="language-plaintext highlighter-rouge">https://hank.momane</code>.</p>


      </p>
    </div>
    

    

</section>

<section class="post">
  <header class="post-header">
    <p class="post-meta">
      <span class="post-date">
        25 AUG 2021
      </span>
      
      •
      
        <a class="post-cat" href="https://momane.com/categories/#browser">browser</a>
        
      
      
    </p>
    <h2>
      <a href="https://momane.com/2021-08-25-firefox-offline-download-official-page" class="post-title" title="Firefox offline installer official download page">Firefox offline installer official download page</a>
      
    </h2>

    

    </header>

    
    <div class="post-description">
      <p>
        <p>Why do I need offline installer of Firefox?</p>

<p>Because its online installer is too slow. (Yes the installer that you download from its index page is online 
installer, basically it’s just a downloader, that
when you run it, it just downloads the offline installer and install it for you. If you don’t feel it’s slow, 
then you don’t need to read this post.)
And maybe the online installer even uses P2P so when it will also upload to others while installing.</p>

<p>So in this <a href="https://www.mozilla.org/en-US/firefox/all/#product-desktop-release">Firefox offline installer download page</a>, 
you can pick any version for any OS to download
the Firefox, like Firefox Developer Edition, Firefox Beta, for Mac, for Windows, fore Linux and even for Android mobile.</p>

<p><img src="../assets/firefox_offline_installer.png" alt="img.png" /></p>

<p>And, here is also <a href="http://www.chromium.org/getting-involved/dev-channel">Chrome release channels</a>, where you can 
download several chrome versions, like Chrome Dev version, Beta, and Canary, for different OS.</p>

<p>Like me, I like running different profile in different versions of Chrome and Firefox, because their icon are different 
,easier than check the profile name in the top right corner.</p>


      </p>
    </div>
    

    

</section>

<section class="post">
  <header class="post-header">
    <p class="post-meta">
      <span class="post-date">
        14 AUG 2021
      </span>
      
      •
      
        <a class="post-cat" href="https://momane.com/categories/#programming">programming</a>
        
      
      
    </p>
    <h2>
      <a href="https://momane.com/do-not-store-file-outside-of-wsl-file-system-its-slow" class="post-title" title="Do not store file outside of WSL, it is slow">Do not store file outside of WSL, it is slow</a>
      
    </h2>

    

    </header>

    
    <div class="post-description">
      <p>
        <p>For some reason, I have switch back to Windows OS after years of working on MacOS.</p>

<p>Most of the time I’m working on frontend projects, so to get better DX, I use Windows Subsystem for Linux (WSL for short). 
And I’m using version 2 of it.</p>

<p>But I’m not a fancy Vim programmer, I heavily relay on IDEs like  VS Code and WebStorm. So I still have to install these IDEs
on the Windows.</p>

<p>I’m able to install zsh, oh-my-zsh, fuck, p10k along with other tools in the WSL, gives me a similar experience as on Mac.</p>

<p>At the first I put the project on Windows file system, because in this way I can easily access the file from IDE. 
And then in the WSL2 terminal, I go to the Windows path like this:</p>
<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">cd</span> /mnt/DISK/PROJECT_FOLDER
</code></pre></div></div>
<p>I can run all these frontend commands like <code class="language-plaintext highlighter-rouge">yarn</code>, <code class="language-plaintext highlighter-rouge">nvm</code>. Seems smooth.</p>

<p>Soon I find a big issue. The hot module replacement not working, the building process is very slow. I have to restart the project 
dev command after making change to the code. Clearly this is not an acceptable solution.</p>

<p>After searching a bit on the internet, I move the project back to WSL file system, then every thing works perfectly. The building is faster,
the HMR is working.</p>

<p>To access the file in WSL from IDEs, VS Code has <a href="https://marketplace.visualstudio.com/items?itemName=ms-vscode-remote.remote-wsl">extension</a> 
to open file from WSL easily, just install it, and in the terminal, just switch to the project folder and type <code class="language-plaintext highlighter-rouge">code .</code>. Or in the IDE, click <code class="language-plaintext highlighter-rouge">File-Open Folder</code>, 
it will show your linux home folder by default. For WebStorm, it will also show the WSL folder in the open file dialog.</p>

<p>Finally, I can use my i7+32G Windows, don’t need to listen to the crazy fan noise on the MBP :D</p>


      </p>
    </div>
    

    

</section>

<section class="post">
  <header class="post-header">
    <p class="post-meta">
      <span class="post-date">
        21 JUN 2021
      </span>
      
      •
      
        <a class="post-cat" href="https://momane.com/categories/#programming">programming</a>
        
      
      
    </p>
    <h2>
      <a href="https://momane.com/a-wrong-solution-on-leetcode" class="post-title" title="A wrong solution on Leetcode">A wrong solution on Leetcode</a>
      
    </h2>

    

    </header>

    
    <div class="post-description">
      <p>
        <p>With all these years as an engineer, I never tried Leetcode.</p>

<p>Maybe it’s because I never prepared for interview before.</p>

<p>Well, now I have to, because the company I just joined in 6 month ago, is gonna shutdown 
it’s office here.</p>

<p>Technically not shutdown, it just lays off every programmer because it thinks we are more expensive than those in 
another country.</p>

<p>So people all say you have to try Leetcode to practice your programming skill.</p>

<p>As a frontend engineer, why should I try it? Most of the time, I’m building UI, calling API, fighting with webpack configuration, 
cursing Google Lighthouse always gives my webpage low score, 
arguing with designer why is same  font size seems so big on production than on Figma…</p>

<p>After I tried to solve some problems on it, I found it is pretty fun, except it made me think myself not a qualified programmer.</p>

<p>For the problem <a href="https://leetcode.com/problems/palindrome-permutation/">palindrome permutation</a>. I found it’s top 1 solution is not correct.</p>

<p>The code is like this:</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">canPermutePalindrome</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">s</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">let</span> <span class="nx">arr</span> <span class="o">=</span> <span class="p">[...</span><span class="k">new</span> <span class="nb">Set</span><span class="p">(</span><span class="nx">s</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="dl">""</span><span class="p">))];</span>
  <span class="kd">let</span> <span class="nx">m</span> <span class="o">=</span> <span class="nx">arr</span><span class="p">.</span><span class="nx">length</span> <span class="o">-</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">ceil</span><span class="p">(</span><span class="nx">s</span><span class="p">.</span><span class="nx">length</span><span class="o">/</span><span class="mi">2</span><span class="p">);</span>
  <span class="k">if</span><span class="p">(</span><span class="nx">arr</span><span class="p">.</span><span class="nx">length</span> <span class="o">==</span> <span class="mi">1</span> <span class="o">||</span> <span class="nx">m</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span> <span class="o">||</span> <span class="nx">m</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>
  <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
  <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
<span class="p">};</span>
</code></pre></div></div>
<p>The code is very short and clean, pretty impressive at the first glance, and most of the cases it works,
Leetcode also thinks it’s a correct one.
But if you try with a string <code class="language-plaintext highlighter-rouge">aaaabbbbcc</code>, it returns <code class="language-plaintext highlighter-rouge">false</code>, while it should be <code class="language-plaintext highlighter-rouge">true</code>. <code class="language-plaintext highlighter-rouge">ababccbaba</code> clearly is a palindrome.
Clearly the test cases could not cover all the scenes
Here is my solution, a simple and basic one:</p>
<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">canPermutePalindrome</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">s</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">let</span> <span class="kd">set</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Set</span><span class="p">()</span>
    <span class="k">for</span> <span class="p">(</span><span class="kd">const</span> <span class="nx">str</span> <span class="k">of</span> <span class="nx">s</span><span class="p">)</span> <span class="p">{</span>
      <span class="kd">set</span><span class="p">.</span><span class="nx">has</span><span class="p">(</span><span class="nx">str</span><span class="p">)</span> <span class="p">?</span> <span class="kd">set</span><span class="p">.</span><span class="k">delete</span><span class="p">(</span><span class="nx">str</span><span class="p">):</span> <span class="kd">set</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">str</span><span class="p">)</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="kd">set</span><span class="p">.</span><span class="nx">size</span> <span class="o">&lt;=</span> <span class="mi">1</span>
<span class="p">};</span>
</code></pre></div></div>
<p>Basically it uses <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Set"><code class="language-plaintext highlighter-rouge">Set</code></a> to store the
unique chars in the string, it should be at last only 1 char with odd amount.</p>

<p>It uses 100ms to execute. Not a very good one, but at least it works :D</p>

      </p>
    </div>
    

    

</section>

<section class="post">
  <header class="post-header">
    <p class="post-meta">
      <span class="post-date">
        7 APR 2021
      </span>
      
      •
      
        <a class="post-cat" href="https://momane.com/categories/#programming">programming</a>
        
      
      
    </p>
    <h2>
      <a href="https://momane.com/how-to-skip-git-hooks-when-committing" class="post-title" title="how to skip git hooks when committing">how to skip git hooks when committing</a>
      
    </h2>

    

    </header>

    
    <div class="post-description">
      <p>
        <p>Well,  it’s not very recommended skipping git hooks. These hooks are often for formatting code, running tests, etc.</p>

<p>But life happens, sometimes you want to commit something quickly or even an empty commit to the server so that you can 
trigger some CI/CD, but you have to wait for 5 min for those tests running.</p>

<p>So if you want to skip git hooks while commting, simply run command like this:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>git commit <span class="nt">--no-verify</span> <span class="nt">-m</span> <span class="s2">"YOUR COMMIT MESSAGE"</span>
</code></pre></div></div>

<p>or for short</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>git commit <span class="nt">-n</span> <span class="nt">-m</span> <span class="s2">"YOUR COMMIT MESSAGE"</span>
</code></pre></div></div>

<p>BTW, the command to push an empty commit is</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>git commit <span class="nt">--allow-empty</span> <span class="nt">-m</span> <span class="s2">"YOUR COMMIT MESSAGE"</span>
</code></pre></div></div>

<p>Just remember only use these commands when you are really urgent and confident about your change.</p>

      </p>
    </div>
    

    

</section>

<section class="post">
  <header class="post-header">
    <p class="post-meta">
      <span class="post-date">
        13 JAN 2021
      </span>
      
      •
      
        <a class="post-cat" href="https://momane.com/categories/#programming">programming</a>
        
        <span>/</span>
        
      
        <a class="post-cat" href="https://momane.com/categories/#front-end">front-end</a>
        
      
      
    </p>
    <h2>
      <a href="https://momane.com/how-ro-fix-enzyme-expects-an-adapter-to-be-configured" class="post-title" title="How to fix: Enzyme expects an adapter to be configured">How to fix: Enzyme expects an adapter to be configured</a>
      
    </h2>

    

    </header>

    
    <div class="post-description">
      <p>
        <p>Working on updating a legacy React project. It’s still using React 8 and Node 7.9, I’d like to upgrate it
to the latest React and Node.</p>

<p>The upgrading process was boring and straight forward, I just upgrade the dependencies and fix those broken changes in some
dependencies, luckily most of them do noe need any change.</p>

<h4 id="problem">Problem</h4>
<p>But when I run jest test, there is an error popup in almost every test file:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Enzyme Internal Error: Enzyme expects an adapter to be configured, but found none. To
configure an adapter, you should call `Enzyme.configure({ adapter: new Adapter() })` 
before using any of Enzyme's top level APIs, where `Adapter` is the adapter 
corresponding to the library currently being tested. For example:

          import Adapter from 'enzyme-adapter-react-16';
</code></pre></div></div>

<p>Searched a bit, it looks like after Enzyme 3.0 and React15, you have to configure the <code class="language-plaintext highlighter-rouge">Adapter</code> to run the tests.</p>

<h4 id="solution">Solution</h4>
<p>To fix it is very simple, just put these lines on the top of your test file:</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>import { configure } from 'enzyme';
import Adapter from 'enzyme-adapter-react-15';

configure({ adapter: new Adapter() });
</code></pre></div></div>

<p>While <code class="language-plaintext highlighter-rouge">enzyme-adapter-react-15</code> is also needed, you will need to use correct version per your react version.</p>

<p>But, what if your project is very large, it has like more than 30 test files, is it mean that you will need to 
put these line on top of every of your test file?</p>

<p>Of course no, here is what you should do.</p>

<ul>
  <li>create a js file, name it as <code class="language-plaintext highlighter-rouge">jestConfig.js</code> or any name you think is best. put it in any path in your 
project.</li>
  <li>either create a <code class="language-plaintext highlighter-rouge">jest.config.js</code> in your project root or a block in <code class="language-plaintext highlighter-rouge">package.json</code> file</li>
  <li>put/append these content into it:</li>
</ul>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code> "jest": {
    // ... other jest configrations
    "setupFilesAfterEnv": ["&lt;rootDir&gt;/path/to/your/jestConfig.js"],
  }
</code></pre></div></div>

<p>Notice that some tutorial might suggest you to do this with old Enzyme version</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code> "jest": {
    // ... other jest configrations
    "setupTestFrameworkScriptFile": "&lt;rootDir&gt;/path/to/your/jestConfig.js"
  }
</code></pre></div></div>

<p>In newer version the key has been changed from <code class="language-plaintext highlighter-rouge">setupTestFrameworkScriptFile</code> to <code class="language-plaintext highlighter-rouge">setupFilesAfterEnv</code>, and 
you can use multiple config file since it now uses array as value.</p>

<h4 id="what-about-react-17">what about React 17</h4>

<p>While the most recent official <code class="language-plaintext highlighter-rouge">ezyme-adapter-react</code> is for 16, the 17 is not surpported yet, so if you 
are using React 17, here is another unofficial package you can use <a href="https://www.npmjs.com/package/@wojtekmaj/enzyme-adapter-react-17">@wojtekmaj/enzyme-adapter-react-17</a></p>

<p>It has more than 6k downloads every week now, seems reliable.</p>


      </p>
    </div>
    

    

</section>

<section class="post">
  <header class="post-header">
    <p class="post-meta">
      <span class="post-date">
        14 DEC 2020
      </span>
      
      •
      
        <a class="post-cat" href="https://momane.com/categories/#life">life</a>
        
      
      
    </p>
    <h2>
      <a href="https://momane.com/why-you-should-not-buy-logitech-k380-keyboard" class="post-title" title="为什么不要买罗技K380无线键盘">为什么不要买罗技K380无线键盘</a>
      
    </h2>

    

    </header>

    
    <div class="post-description">
      <p>
        <p>罗技K380无线键盘，被很多平台吹为几乎最佳的移动设备伴侣键盘，深受很多iPad乃至MacBook用户的欢迎。</p>

<p>其优点有：蓝牙连接，最多可以连接三台设备，切换便捷。轻薄小巧，手感和笔记本键盘非常相似。而多色键帽更满足了不同审美用户的需求。</p>

<p>因为有移动办公的需求，而Macbook的键盘手感实在太烂，所以前段时间我也买了一个，用了不多几次发现这是一个非常烂的键盘。</p>

<p>手感差其实没有什么可以挑剔的，要做到轻薄小巧，必然牺牲键程和手感。</p>

<p>但是其做工和用料却非常差，放在包里背了几次，就掉了一个键。不像其他键盘，键帽掉了以后按上去就可以了。K380的这个键帽我怎么装都装不上去。</p>

<p>看了一下还在保修期内，就送回京东售后维修。</p>

<p>然而京东最终给的答复是，键帽掉落属于外观损伤，不属于质量问题，拒绝保修。直接返回来了。</p>

<p>返回后我一看，不但掉落的键没有装上去，旁边还多掉了一个键。仔细看了一下，之前掉落的键里面的卡件已经被按平，所以可以猜想是京东的售后人员先是尝试将按键按照传统方式按回去，暴力按了几下以后发现装不上，
然后又想拆旁边的键看一下结构怎么装。</p>

<p>结果拆了以后没看出所以然来，新拆的这个键也装不回去了。就把键盘按键这种核心部件说成外观拒绝保修了。</p>

<p>话说最近在另外一个网站看到有人的耳机罩在保修期内自动裂开，内部部件外露，送到京东也是以属于外观问题不予保修拒绝售后。</p>

<p>不知道京东以相似的理由拒绝了多少保修。</p>

<p>吐槽完京东，再仔细研究一下这个键盘，其剪刀脚结构是纯塑料，而且是非常脆弱的那种，稍微用点力就很容易变形乃至断掉，这个键就没用了。而键帽下面的连接件也是非常小而软的金属挂钩，很容易变形，当然也可以给掰回来，但是如果掰次数多了，就会断掉。</p>

<p>也就是说，<strong>如果你的K380键帽掉了，千万不要像其他键盘那样，尝试用力将键帽按回去，不但装不回去，还有可能永久损伤键帽甚至键帽下面的连接件</strong>，连接件一旦坏了，键盘就废了，除非你能接受键盘少一个键。</p>

<p>如果损伤键帽，淘宝上有几家卖的，估计就是送修或者报废的k380拆了卖零件的。</p>

<p>一个键帽是10块钱起，下面的剪刀脚也是10块，不包邮。卖一排键帽就能买一个新的K380。</p>

<p>所以如果你的K380键帽坏了，不要去买键帽，上淘宝或者其他二手平台卖键帽，然后拿换来的钱买一把新的键盘。</p>

<p>当然买新键盘千万别再买k380了。</p>


      </p>
    </div>
    

    

</section>

<section class="post">
  <header class="post-header">
    <p class="post-meta">
      <span class="post-date">
        18 OCT 2020
      </span>
      
      •
      
        <a class="post-cat" href="https://momane.com/categories/#programming">programming</a>
        
      
      
    </p>
    <h2>
      <a href="https://momane.com/how-to-copy-image-and-text-to-clipboard-with-javascript" class="post-title" title="How to copy image and text to clipboard with JavaScript">How to copy image and text to clipboard with JavaScript</a>
      
    </h2>

    

    </header>

    
    <div class="post-description">
      <p>
        <p>I used to saw my colleague add a 30kb lib only to implement a copy function
that when the user clicks on a text, copy it to the clipboard.</p>

<p>And I also saw someone still trying to use flash or Clipboard lib to do the same thing.</p>

<h4 id="here-is-how-to-copy-text-to-your-clipboard-with-javascript-with-just-several-lines-of-code-and-its-cross-browser">Here is how to copy text to your clipboard with JavaScript with just several lines of code. And it’s cross-browser</h4>
<p>and device. No need for any 3rd party lib.</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">function</span> <span class="nx">copyToClipboard</span><span class="p">(</span><span class="nx">text</span><span class="p">){</span>
 <span class="kd">const</span> <span class="nx">ta</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="dl">'</span><span class="s1">textarea</span><span class="dl">'</span><span class="p">);</span>
 <span class="nx">ta</span><span class="p">.</span><span class="nx">value</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">url</span><span class="p">;</span>
 <span class="nb">document</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">ta</span><span class="p">);</span>
 <span class="c1">//hide it</span>
 <span class="nx">ta</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">padding</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
 <span class="nx">ta</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">border</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">none</span><span class="dl">'</span><span class="p">;</span>
 <span class="nx">ta</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">outline</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">none</span><span class="dl">'</span><span class="p">;</span>
 <span class="nx">ta</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">boxShadow</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">none</span><span class="dl">'</span><span class="p">;</span>
 <span class="c1">//select the text</span>
 <span class="nx">ta</span><span class="p">.</span><span class="nx">focus</span><span class="p">();</span>
 <span class="nx">ta</span><span class="p">.</span><span class="nx">select</span><span class="p">();</span>
 <span class="nb">document</span><span class="p">.</span><span class="nx">execCommand</span><span class="p">(</span><span class="dl">'</span><span class="s1">copy</span><span class="dl">'</span><span class="p">);</span>
 <span class="nb">document</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">removeChild</span><span class="p">(</span><span class="nx">ta</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div></div>

<p>it’s very simple, you just append an invisible textarea to the page, set value as the text you want to copy,
and run <code class="language-plaintext highlighter-rouge">document.execCommand('copy')</code>. Then remove the textarea from the page.</p>

<h4 id="here-is-how-to-copy-the-image-to-your-clipboard-with-javascript">here is how to copy the image to your clipboard with JavaScript</h4>
<p>Note that this one only works on Chrome and Edge right now (2020-10)
https://caniuse.com/mdn-api_clipboarditem</p>

<p>This requires you to use <code class="language-plaintext highlighter-rouge">canvas</code> to port the image to blob first.</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">function</span> <span class="nx">imageToBlob</span><span class="p">(</span><span class="nx">imageURL</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">const</span> <span class="nx">img</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Image</span><span class="p">;</span>
  <span class="kd">const</span> <span class="nx">c</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="dl">"</span><span class="s2">canvas</span><span class="dl">"</span><span class="p">);</span>
  <span class="kd">const</span> <span class="nx">ctx</span> <span class="o">=</span> <span class="nx">c</span><span class="p">.</span><span class="nx">getContext</span><span class="p">(</span><span class="dl">"</span><span class="s2">2d</span><span class="dl">"</span><span class="p">);</span>
  <span class="nx">img</span><span class="p">.</span><span class="nx">crossOrigin</span> <span class="o">=</span> <span class="dl">""</span><span class="p">;</span>
  <span class="nx">img</span><span class="p">.</span><span class="nx">src</span> <span class="o">=</span> <span class="nx">imageURL</span><span class="p">;</span>
  <span class="k">return</span> <span class="k">new</span> <span class="nb">Promise</span><span class="p">(</span><span class="nx">resolve</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="nx">img</span><span class="p">.</span><span class="nx">onload</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
      <span class="nx">c</span><span class="p">.</span><span class="nx">width</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">naturalWidth</span><span class="p">;</span>
      <span class="nx">c</span><span class="p">.</span><span class="nx">height</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">naturalHeight</span><span class="p">;</span>
      <span class="nx">ctx</span><span class="p">.</span><span class="nx">drawImage</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
      <span class="nx">c</span><span class="p">.</span><span class="nx">toBlob</span><span class="p">((</span><span class="nx">blob</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="c1">// here the image is a blob</span>
        <span class="nx">resolve</span><span class="p">(</span><span class="nx">blob</span><span class="p">)</span>
      <span class="p">},</span> <span class="dl">"</span><span class="s2">image/png</span><span class="dl">"</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">);</span>
    <span class="p">};</span>
  <span class="p">})</span>
<span class="p">}</span>
</code></pre></div></div>

<p>Then use the <code class="language-plaintext highlighter-rouge">Clipboard</code> API to do the magic</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="k">async</span> <span class="kd">function</span> <span class="nx">copyImage</span><span class="p">(</span><span class="nx">imageURL</span><span class="p">){</span>
  <span class="kd">const</span> <span class="nx">blob</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">imageToBlob</span><span class="p">(</span><span class="nx">imageURL</span><span class="p">)</span>
  <span class="kd">const</span> <span class="nx">item</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ClipboardItem</span><span class="p">({</span> <span class="dl">"</span><span class="s2">image/png</span><span class="dl">"</span><span class="p">:</span> <span class="nx">blob</span> <span class="p">});</span>
  <span class="nb">navigator</span><span class="p">.</span><span class="nx">clipboard</span><span class="p">.</span><span class="nx">write</span><span class="p">([</span><span class="nx">item</span><span class="p">]);</span>
<span class="p">}</span>
</code></pre></div></div>

<p>Simple as that.</p>

      </p>
    </div>
    

    

</section>

<section class="post">
  <header class="post-header">
    <p class="post-meta">
      <span class="post-date">
        15 SEP 2020
      </span>
      
      •
      
        <a class="post-cat" href="https://momane.com/categories/#programming">programming</a>
        
      
      
    </p>
    <h2>
      <a href="https://momane.com/debug-webpage-on-mobile-and-wechat-in-chrome" class="post-title" title="如何在电脑上调试手机真机网页以及微信浏览器网页">如何在电脑上调试手机真机网页以及微信浏览器网页</a>
      
    </h2>

    

    </header>

    
    <div class="post-description">
      <p>
        <p>遇到个需求需要调试在微信中打开的网页。之前没有做过，搜了一圈那个所谓的在微信对话框中打开debugx5.qq.com的方法已经过时无用， 打开就显示你所使用对内核非X5内核。至于TBStool更是在2017年就已经停止更新，打开就闪退，浪费时间安装。</p>

<p>看来因为开发人员对QQ搞出来的X5内核怨声载道，所以微信不得不妥协，弃用了X5内核作为内置浏览器内核了。</p>

<p>至于spy-debugger等工具，我嫌麻烦也没装。</p>

<p>找半天找不到有用的方法，好在同样的问题在手机上的Chrome里面打开也存在，于是就想先在Chrome里调试，万一能一起修复了呢。</p>

<p>没想到就发现了Chrome调试工具居然也可以调试微信浏览器里打开的页面。看起来微信内建浏览器也采用了Chromium内核了。</p>

<p>以下步骤同时适用于在电脑上调试手机浏览器网页调试和微信内建浏览器网页， 目前只限Android系统。iPhone还没去看。</p>

<ul>
  <li>
    <p>打开手机的开发者模式，这个各个手机打开方式都差不多，通过多次点击版本号来开启。</p>
  </li>
  <li>
    <p>在开发者模式里面打开 USB 调试功能</p>
  </li>
  <li>
    <p>把你要调试的网址发送到微信对话框里，然后点击打开</p>
  </li>
  <li>
    <p>将手机通过USB数据线连接到电脑</p>
  </li>
  <li>
    <p>在电脑上打开Chrome浏览器</p>
  </li>
  <li>
    <p>新建一个标签页，输入网址 <code class="language-plaintext highlighter-rouge">chrome://inspect/#devices</code>。以前你需要在 Chrome 的开发者工具里面通过点击多个菜单来打开，Chrome现在将这个页面独立出来了，体验更佳。</p>
  </li>
  <li>
    <p>这时候你的手机应该会收到 <code class="language-plaintext highlighter-rouge">允许当前连接的设备访问手机数据</code> 的通知，点击允许即可</p>
  </li>
  <li>
    <p>在电脑端 Chrome 的 <code class="language-plaintext highlighter-rouge">chrome://inspect/#devices</code> 里面就应该能看到你手机 Chrome 里面打开的页面了</p>
  </li>
  <li>
    <p>同时如果你已经在微信内建浏览器里打开了网页，你应该也能看到一个名为 <code class="language-plaintext highlighter-rouge">com.tencent.mm</code> 的浏览器里面打开了一个页面。
<img src="../img/chrome-mobile-debug-devices.png" /></p>
  </li>
  <li>
    <p>点击网址下面的 <code class="language-plaintext highlighter-rouge">inspect</code> 就可以打开调试页面，其拥有电脑端Chrome开发工具的几乎所有调试功能。
<img src="../img/chrome-mobile-debug-website.png" /></p>
  </li>
</ul>

<p>不得不说发现这点还是挺惊喜的。</p>


      </p>
    </div>
    

    

</section>

<section class="post">
  <header class="post-header">
    <p class="post-meta">
      <span class="post-date">
        10 SEP 2020
      </span>
      
      •
      
        <a class="post-cat" href="https://momane.com/categories/#programming">programming</a>
        
      
      
    </p>
    <h2>
      <a href="https://momane.com/shout-out-to-jetbrains-ide" class="post-title" title="Shout out to Jetbrains IDE">Shout out to Jetbrains IDE</a>
      
    </h2>

    

    </header>

    
    <div class="post-description">
      <p>
        <p><a href="https://www.jetbrains.com/?from=one-click-extensions-manager" target="_blank"><img src="../assets/jetbrains.svg" style="width:200px;" /></a></p>

<p>I write this post because <a href="https://www.jetbrains.com/?from=one-click-extensions-manager">Jetbrains</a> just gave me full access to all its tools as an open source project developer.
So I just want to say thanks with this post.</p>

<p>After I tried Webstorm for several days, I found it’s much better than VS Code.</p>

<p>What am I saying, Webstorm is a commercial software, while VS Code is open source and free. 😅</p>

<p>Anyway, I found myself coding much faster with Webstorm and other <a href="https://www.jetbrains.com/?from=one-click-extensions-manager">Jetbrains</a> tools. Like, I don’t have to pick and configure all those extensions carefully to make so that it won’t popup css selector when I’m coding JavaScript. Webstorm also has built-in spell check, it’s like a life saver for non-native English speaker.</p>

<p>Some people might think that VS code eats less RAM than Webstorm, also faster when launching.  While  my computer has 32 GB RAM and i7, so I never need to care about the RAM. Plus, if you install and enable too many extensions, you can also notice that VS Code takes a lot of RAM too.</p>

<p>And I barely need to code some stuff within 30 sec, so the launching time is not an issue to me too. This is not mean I’m not gonna use VS Code, it’s still great, especially it can edit any programming languages, with extensions.</p>

<p>Its price is also reasonable, for individual, most of the tools are between $59 - $69 for the first year, cheaper for the next years.</p>

<p>It also has many free plans, students, teachers, etc. If you are an active open source developer, you can even ask for a free license.</p>

<p>Like me, since I have this small open source project <a href="https://github.com/hankxdev/one-click-extensions-manager">one click extensions manager</a>, it has more than 30k users.</p>

<p><a href="https://www.jetbrains.com/?from=one-click-extensions-manager">Jetbrains</a> gives me full access to all its tools for a year, and can be re-subscribed every year.</p>

<p>So if you also have open source project, try to apply for its license and try this great IDE :D</p>


      </p>
    </div>
    

    

</section>

<section class="post">
  <header class="post-header">
    <p class="post-meta">
      <span class="post-date">
        29 AUG 2020
      </span>
      
      •
      
        <a class="post-cat" href="https://momane.com/categories/#programming">programming</a>
        
      
      
    </p>
    <h2>
      <a href="https://momane.com/how-to-zip-only-source-code" class="post-title" title="Use git archive to zip your source code">Use git archive to zip your source code</a>
      
    </h2>

    

    </header>

    
    <div class="post-description">
      <p>
        <p>To zip compiled project file is easy, normally I just use <a href="">archivejs</a>, write a small nodejs script, and then add a script in <code class="language-plaintext highlighter-rouge">package.json</code>.</p>

<p>And then I need to zip the source code only. Exclude the dist folder, the huge <code class="language-plaintext highlighter-rouge">node_modules</code> folder and other folders.</p>

<p>Basically just source code and exclude everything in .gitignore file.</p>

<p>I tried to use <code class="language-plaintext highlighter-rouge">archivejs</code>’s <code class="language-plaintext highlighter-rouge">glob</code> api. Like so:</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">archive</span><span class="p">.</span><span class="nx">glob</span><span class="p">(</span><span class="dl">'</span><span class="s1">**</span><span class="dl">'</span><span class="p">,</span> <span class="p">{</span>
  <span class="na">ignore</span><span class="p">:</span> <span class="p">[</span><span class="dl">'</span><span class="s1">folder/**</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">file</span><span class="dl">'</span><span class="p">]</span>
<span class="p">})</span>
</code></pre></div></div>

<p>But I could not make it works, it either zip nothing or zip everything in my folder, I think it’s because the path that I set is not correct. And I don’t want to 
spend too much time on reading and exploring archivejs’s api doc.</p>

<p>So I came to use <code class="language-plaintext highlighter-rouge">zip</code> command in terminal. To use it is very simple, just use <code class="language-plaintext highlighter-rouge">-x</code> to exclude file, like this</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>zip <span class="nt">-r</span> output.zip directory <span class="nt">-x</span> <span class="se">\*\*</span>/<span class="se">\*</span>/node_modules/<span class="se">\*</span>
</code></pre></div></div>

<p>Which is great. But the command is too long and if there are many files you want to exclude, you will need to write down them every time.</p>

<p>At the same time I found that with <code class="language-plaintext highlighter-rouge">git archive</code> I can do this easily. so just run</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>git archive <span class="nt">--format</span><span class="o">=</span>zip HEAD <span class="nt">-o</span> zipfile.zip
</code></pre></div></div>

<p>it will pack all your source code into zip file, exclude everything in the .gitignore file. Super neat.</p>

      </p>
    </div>
    

    

</section>

<section class="post">
  <header class="post-header">
    <p class="post-meta">
      <span class="post-date">
        6 AUG 2020
      </span>
      
      •
      
        <a class="post-cat" href="https://momane.com/categories/#programming">programming</a>
        
      
      
    </p>
    <h2>
      <a href="https://momane.com/how-to-use-jquery-with-typescript" class="post-title" title="how to use jQuery with TypeScript">how to use jQuery with TypeScript</a>
      
    </h2>

    

    </header>

    
    <div class="post-description">
      <p>
        <p>It’s 2020, why do you still need to use jQuery?</p>

<p>Yeah, jQuery has 53.8k stars on Github. And still, there are more than 97% of websites are using it.</p>

<p>Even if you don’t want to use it in your fancy project. It’s still a good choice to use it when you are building a demo, prototype, or some small side project. I mean, when you are configuring your fancy project with wepack, react/vue/angular, babel, I already have done a small page which can send request to the API and show the result on the page.</p>

<p>Anyway, if you want to use jQuery with TypeScript. Here are the steps that you need to do.</p>

<h4 id="add-jquery">add jquery</h4>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>yarn add jquery
</code></pre></div></div>

<h3 id="add-jquery-types">add jquery types</h3>

<p>this will suppress VS Code complains that it can not find jquery types</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>yarn add @types/jquery
</code></pre></div></div>

<h3 id="config-tsconfigjson-to-suppress-another-warning-message">config tsconfig.json to suppress another warning message</h3>

<blockquote>
  <p>can only be default-imported using the ‘allowSyntheticDefaultImports’ flagts(1259)
index.d.ts(35, 1): This module is declared with using ‘export =’, and can only be used with a default import when using the ‘allowSyntheticDefaultImports’ flag.</p>
</blockquote>

<p>goto your <code class="language-plaintext highlighter-rouge">tsconfig.json</code> file, add one line in your the <code class="language-plaintext highlighter-rouge">compilerOptions</code> block. if you don’t have this tsconfig file in your project’s root folder, then create one.</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nl">"allowSyntheticDefaultImports"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="err">,</span><span class="w">
</span></code></pre></div></div>

<p>Then you can use jquery in your ts file like this:</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="nx">$</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">jquery</span><span class="dl">'</span>

<span class="nx">$</span><span class="p">.</span><span class="nx">ajax</span><span class="p">().</span><span class="nx">then</span><span class="p">().</span><span class="k">catch</span><span class="p">().</span><span class="nx">finnally</span><span class="p">()</span>
</code></pre></div></div>

      </p>
    </div>
    

    

</section>

<section class="post">
  <header class="post-header">
    <p class="post-meta">
      <span class="post-date">
        5 AUG 2020
      </span>
      
      •
      
        <a class="post-cat" href="https://momane.com/categories/#programming">programming</a>
        
      
      
    </p>
    <h2>
      <a href="https://momane.com/a-wechat-mini-app-with-taro-vue" class="post-title" title="用 Taro 和 Vue 写了一个微信小程序">用 Taro 和 Vue 写了一个微信小程序</a>
      
    </h2>

    

    </header>

    
    <div class="post-description">
      <p>
        <p>最近尝试写微信小程序，毕竟是现在的趋势。然后发现因为入场太晚，各种轮子已经造得遍地飞了。比如这里有一个框架，出自京东，叫做Taro，它的目的是写一份代码，就可以在诸如微信、支付宝、字节跳动（它家的什么app支持小程序？）等端作为小程序运行。</p>

<p>于是拿来试了以下。我本来只熟悉Vue的，这个Taro原生支持React，代码风格也都是React的样式。虽说现在3.0以上支持Vue了，可是要做的时候还是有一些转换成本。</p>

<p>然后框架本身也还存在一些bug，不过一次编写，多端运行还是挺有意思的。</p>

<p>项目地址：https://github.com/hankxdev/taro-v2ex</p>

<p>以下内容来自README：</p>

<h3 id="taro--taro-ui--vue--v2ex-api-多端小程序">Taro + Taro-UI + Vue + V2EX API 多端小程序</h3>

<p>如题，这是一个使用了这几个技术的练习项目。我是第一次使用Taro和写微信小程序。Taro官方有个<a href="https://taro-docs.jd.com/taro/docs/guide/">渐进式教程</a>，使用的也是V2EX的API。</p>
<h4 id="技术栈">技术栈：</h4>
<ul>
  <li><a href="https://github.com/NervJS/taro">Taro</a></li>
  <li><a href="https://github.com/NervJS/taro-ui">Taro-UI</a></li>
  <li><a href="http://taro-ui-vue.fontend.com/">Taro-ui-vue</a></li>
  <li><a href="https://github.com/igaozp/V2EX-API">V2EX API</a></li>
  <li>Vue</li>
  <li>Vuex</li>
  <li>SCSS</li>
  <li>Typescript</li>
</ul>

<h4 id="本地运行和测试">本地运行和测试</h4>
<ul>
  <li><code class="language-plaintext highlighter-rouge">yarn</code></li>
  <li><code class="language-plaintext highlighter-rouge">yarn dev:weapp</code></li>
  <li>因为调用了v2ex 的API，用自己的微信小程序ID的话，需要去后台设置一下域名白名单，否则 API 调用会失败。</li>
</ul>

<h4 id="比教程多了一些的是">比教程多了一些的是：</h4>
<ul>
  <li>代码完整。官方教程的代码比较零散，甚至有些跑不通。</li>
  <li>用户详情页面和节点详情页面</li>
  <li>全部使用真正的V2EX API 而不是使用自定义数据</li>
  <li>自定义 Tabbar</li>
  <li>使用了Taro-UI来做界面</li>
</ul>

<h4 id="项目存在的问题">项目存在的问题：</h4>
<p>以下是我知道的主要问题。大佬们如果发现新问题或者知道这些问题的答案，欢迎提 issues 或者 PR， 望不吝赐教。</p>

<ul>
  <li>几个页面在切换的时候并不会刷新。这里怀疑是Taro的bug，文档中写的 <a href="https://nervjs.github.io/taro/docs/vue/#onshow-1">onShow</a> 方法并不能在页面显示的时候被成功调用。</li>
  <li>不怎么好看。因为主要用来熟悉Taro以及微信小程序和多端小程序开发，因此并未在界面上花功夫，几乎没有怎么写样式。使用的全都是Taro-UI 默认的组件。</li>
  <li>有点卡。一方面v2ex并未提供分页的API。有些 endpoints 诸如获得节点列表、帖子列表等，都是一大堆上千条数据一下子全返回。网络慢的时候导致卡顿更加明显。</li>
  <li>TypeScript 使用并不规范。我很少写 TypeScript。也一直懒得学，因此基本上都是用JavaScript 的写法在写 TypeScript。同样，写好或者学习 TypeScript 也并不是我写本项目的目的。略过。</li>
  <li>CustomTabBar 的实现并不规范。现在的做法是写一个 CustomTabBar, 然后放置进每个页面中。正确的做法应该是。
    <ol>
      <li>在 <code class="language-plaintext highlighter-rouge">app.config.ts</code> 中的<code class="language-plaintext highlighter-rouge">tabList</code> 里，设置 <code class="language-plaintext highlighter-rouge">custom: true</code></li>
      <li>在 <code class="language-plaintext highlighter-rouge">src</code> 目录下新建 <code class="language-plaintext highlighter-rouge">custome-tab-bar</code> 文件夹</li>
      <li>在 <code class="language-plaintext highlighter-rouge">custome-tab-bar</code> 下面添加 <code class="language-plaintext highlighter-rouge">index.js</code>,<code class="language-plaintext highlighter-rouge">index.wxml</code>, <code class="language-plaintext highlighter-rouge">index.wxss</code> 来自定义 tabbar 的样式和行为。 需要注意的是，这里不能直接写 <code class="language-plaintext highlighter-rouge">index.vue</code>，编译不出来的。</li>
    </ol>
  </li>
</ul>

<p><img src="https://github.com/hankxdev/taro-v2ex/raw/master/readme/hot.png" alt="hot" /></p>

      </p>
    </div>
    

    

</section>

<section class="post">
  <header class="post-header">
    <p class="post-meta">
      <span class="post-date">
        14 JUL 2020
      </span>
      
      •
      
        <a class="post-cat" href="https://momane.com/categories/#system">system</a>
        
      
      
    </p>
    <h2>
      <a href="https://momane.com/how-to-fix-git-show-all-file-as-modified-in-wsl" class="post-title" title="How to fix Git show all file as modified in WSL">How to fix Git show all file as modified in WSL</a>
      
    </h2>

    

    </header>

    
    <div class="post-description">
      <p>
        <h2 id="solution">Solution</h2>
<p>If you open your code in Windows, and run git in WSL bash, you will have a big chance to meet an issue that <code class="language-plaintext highlighter-rouge">git status</code> shows all your
file get modified.
To fix the issue, run this in WSL bash:</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>git config <span class="nt">--global</span> core.autocrlf <span class="nb">true</span>
</code></pre></div></div>

<p>Normally I use OSX, but today I have to go back to my Windows PC to try an extension on Edge.</p>

<p>I’m using WSL (that’s Windows Subsystem for Linux) to manage and build my projects.</p>

<p>After I cloned my repo from Github, I tried to create a new branch for Edge version. But after I ran <code class="language-plaintext highlighter-rouge">git branch branchname</code>
, it told me that there were changes need to commit first.</p>

<p>So I ran <code class="language-plaintext highlighter-rouge">git status</code>, to check what’s been changed. Then I got this:</p>

<p><img src="../img/wsl-change-all.png" alt="all files modified" /></p>

<p>This was a simple app. so it’s basically showing that every file got modified. But I hadn’t do anything to any file.</p>

<p>It’s because I was using git in WSL, but I opened files in Windows system. So the line ending is <code class="language-plaintext highlighter-rouge">CRLF</code>, but git thought it’s on Linux so the 
line should ends with <code class="language-plaintext highlighter-rouge">LF</code>.</p>

<p>So the fix command will tell git to use <code class="language-plaintext highlighter-rouge">CRLF</code> and line ending.</p>

      </p>
    </div>
    

    

</section>

<section class="post">
  <header class="post-header">
    <p class="post-meta">
      <span class="post-date">
        13 JUL 2020
      </span>
      
      •
      
        <a class="post-cat" href="https://momane.com/categories/#system">system</a>
        
      
      
    </p>
    <h2>
      <a href="https://momane.com/change-ubuntu-20-04-source-to-china-mirror" class="post-title" title="Change Ubuntu 20.04 update source to mirror site in China">Change Ubuntu 20.04 update source to mirror site in China</a>
      
    </h2>

    

    </header>

    
    <div class="post-description">
      <p>
        <p>Ubuntu 20.04 has been released for a while, its code is <code class="language-plaintext highlighter-rouge">Focal Fossa</code>.  Again, if you are in China, better change the update source to mirror sites.</p>

<p>This post is just a copy from <a href="https://momane.com/change-ubuntu-18-04-source-to-china-mirror">Change Ubuntu 18.04 update source to mirror site in China</a>, and I just replaced the source url from thoes ones of 18.04 to 20.04</p>

<p>Here are several famous mirror sites. What you need todo is pick one from below and edit <code class="language-plaintext highlighter-rouge">etc/apt/sources.list</code>, replace the content in this file.</p>

<p>There are some links beend commented out.</p>

<ul>
  <li>starts with<code class="language-plaintext highlighter-rouge">deb-src</code> is for source code, without them the speed would be even faster</li>
  <li>the one with <code class="language-plaintext highlighter-rouge">focal-proposed</code> are just proposed updates, only enable them if you know the risk.</li>
</ul>

<p><strong>Better backup you <code class="language-plaintext highlighter-rouge">etc/apt/sources.list</code> before you do this</strong></p>

<h4 id="163-netease">163 (netease)</h4>
<p><em>source:http://mirrors.163.com/</em></p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>deb http://mirrors.163.com/ubuntu/ focal main restricted universe multiverse
deb http://mirrors.163.com/ubuntu/ focal-security main restricted universe multiverse
deb http://mirrors.163.com/ubuntu/ focal-updates main restricted universe multiverse
deb http://mirrors.163.com/ubuntu/ focal-backports main restricted universe multiverse
# deb http://mirrors.163.com/ubuntu/ focal-proposed main restricted universe multiverse
# deb-src http://mirrors.163.com/ubuntu/ focal main restricted universe multiverse
# deb-src http://mirrors.163.com/ubuntu/ focal-security main restricted universe multiverse
# deb-src http://mirrors.163.com/ubuntu/ focal-updates main restricted universe multiverse
# deb-src http://mirrors.163.com/ubuntu/ focal-proposed main restricted universe multiverse
# deb-src http://mirrors.163.com/ubuntu/ focal-backports main restricted universe multiverse
</code></pre></div></div>

<h4 id="alibaba-aliyun">alibaba (aliyun)</h4>
<p><em>source:https://opsx.alibaba.com/mirror</em></p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>deb http://mirrors.aliyun.com/ubuntu/ focal main restricted universe multiverse
deb http://mirrors.aliyun.com/ubuntu/ focal-security main restricted universe multiverse
deb http://mirrors.aliyun.com/ubuntu/ focal-updates main restricted universe multiverse
deb http://mirrors.aliyun.com/ubuntu/ focal-backports main restricted universe multiverse
# deb http://mirrors.aliyun.com/ubuntu/ focal-proposed main restricted universe multiverse
# deb-src http://mirrors.aliyun.com/ubuntu/ focal main restricted universe multiverse
# deb-src http://mirrors.aliyun.com/ubuntu/ focal-security main restricted universe multiverse
# deb-src http://mirrors.aliyun.com/ubuntu/ focal-backports main restricted universe multiverse
# deb-src http://mirrors.aliyun.com/ubuntu/ focal-updates main restricted universe multiverse
# deb-src http://mirrors.aliyun.com/ubuntu/ focal-proposed main restricted universe multiverse
</code></pre></div></div>
<p>And here are also two Chinese university mirror, use them only if you are in Chinese university.</p>
<h4 id="tsinghua-university">tsinghua university</h4>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal main restricted universe multiverse
deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal-updates main restricted universe multiverse
deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal-backports main restricted universe multiverse
deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal-security main restricted universe multiverse
# deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal-proposed main restricted universe multiverse
# deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal main restricted universe multiverse
# deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal-updates main restricted universe multiverse
# deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal-backports main restricted universe multiverse
# deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal-security main restricted universe multiverse
# deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal-proposed main restricted universe multiverse
</code></pre></div></div>

<h4 id="ustc-university-of-science-and-technology-of-china">ustc (university of science and technology of China)</h4>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>deb https://mirrors.ustc.edu.cn/ubuntu/ focal main restricted universe multiverse
deb https://mirrors.ustc.edu.cn/ubuntu/ focal-updates main restricted universe multiverse
deb https://mirrors.ustc.edu.cn/ubuntu/ focal-backports main restricted universe multiverse
deb https://mirrors.ustc.edu.cn/ubuntu/ focal-security main restricted universe multiverse
# deb https://mirrors.ustc.edu.cn/ubuntu/ focal-proposed main restricted universe multiverse
# deb-src https://mirrors.ustc.edu.cn/ubuntu/ focal main restricted universe multiverse
# deb-src https://mirrors.ustc.edu.cn/ubuntu/ focal-updates main restricted universe multiverse
# deb-src https://mirrors.ustc.edu.cn/ubuntu/ focal-backports main restricted universe multiverse
# deb-src https://mirrors.ustc.edu.cn/ubuntu/ focal-security main restricted universe multiverse
# deb-src https://mirrors.ustc.edu.cn/ubuntu/ focal-proposed main restricted universe multiverse
</code></pre></div></div>

<p>Enjoy:)</p>


      </p>
    </div>
    

    

</section>

<section class="post">
  <header class="post-header">
    <p class="post-meta">
      <span class="post-date">
        2 JUL 2020
      </span>
      
      •
      
        <a class="post-cat" href="https://momane.com/categories/#programming">programming</a>
        
        <span>/</span>
        
      
        <a class="post-cat" href="https://momane.com/categories/#chrome">chrome</a>
        
      
      
    </p>
    <h2>
      <a href="https://momane.com/fix-you-have-to-set-a-contract-email-chrome-web-store" class="post-title" title="How to fix You have to set a contact email in Chrome Web Store">How to fix You have to set a contact email in Chrome Web Store</a>
      
    </h2>

    

    </header>

    
    <div class="post-description">
      <p>
        <p>I have multiple accounts in Chrome Web Store to manage multiple Chrome extensions.</p>

<p>Today I found that one of my extension <a href="https://chrome.google.com/webstore/detail/one-click-extensions-mana/pbgjpgbpljobkekbhnnmlikbbfhbhmem">one click extensions manager</a> did not get updated as schedule. which is very abnormal because it’s scheduled by Github action, and the log shows that the latest version had been submitted to the store several days ago.</p>

<p>In the dashboard it’s telling me to add a contract email in my account so that I could publish it. And I already added it long time ago.</p>

<p>After several meaningless refreshes and clicking on the save button, I realized it might because of my other accounts. So I switched to other accounts and found there is one account without contact email. And the item got published once I fixed this issue.</p>

<p>So weird because it never asks me to add contact email before. And the store hint is so unclear, it needs you to add contact email on every account, not just the current one.</p>

<p>Honestly, the new Chrome web store dashboard is not as easy to use as the old one.
Only the UI is fresher than before.</p>

<p><img src="../img/chrome-web-store-ask-contact-email.png" style="margin-bottom:15px;" alt="chrome web store asks for contact email" width="800" /></p>

<p>Also, got an email from Microsoft Edge team, they ask me to submit my extension to Edge store, as Edge is using Chromium now. So if you have published Chrome extension before, you can try 
to submit it to Edge store too. The process would take less than 30 min to do it.</p>

<p>And, the Edge store dashboard is hard to use too, especially if your extension surppots multiple language, you will need to set information like logo, screenshot, description for every
language. insane, right?.</p>


      </p>
    </div>
    

    

</section>

<section class="post">
  <header class="post-header">
    <p class="post-meta">
      <span class="post-date">
        21 JUN 2020
      </span>
      
      •
      
        <a class="post-cat" href="https://momane.com/categories/#life">life</a>
        
      
      
    </p>
    <h2>
      <a href="https://momane.com/my-first-lego-friends" class="post-title" title="My First LEGO">My First LEGO</a>
      
    </h2>

    

    </header>

    
    <div class="post-description">
      <p>
        <p>Got a LEGO gift from an old friend. Finished it in two weeks :D Love it a lot.</p>

<div><img src="../_site/../img/friends_lego.jpeg" style="margin-bottom:15px;" alt="LEGO Friends" width="800" /></div>
<div><img src="../_site/../img/friends_lego1.jpeg" style="margin-bottom:15px;" alt="LEGO Friends" width="800" /></div>
<div><img src="../_site/../img/friends_lego2.jpeg" style="margin-bottom:15px;" alt="LEGO Friends" width="800" /></div>
<div><img src="../_site/../img/friends_lego3.jpeg" style="margin-bottom:15px;" alt="LEGO Friends" width="800" /></div>


      </p>
    </div>
    

    

</section>

<section class="post">
  <header class="post-header">
    <p class="post-meta">
      <span class="post-date">
        21 JUN 2020
      </span>
      
      •
      
        <a class="post-cat" href="https://momane.com/categories/#system">system</a>
        
      
      
    </p>
    <h2>
      <a href="https://momane.com/merlin-overclocking" class="post-title" title="安装了梅林固件的路由器开启SSH以及超频">安装了梅林固件的路由器开启SSH以及超频</a>
      
    </h2>

    

    </header>

    
    <div class="post-description">
      <p>
        <p>部分路由器可以通过安装Merlin梅林固件来实现更多的自定义功能。安装更多第三方插件来让路由器变得更强大。</p>

<p>在软件自定义的时候不妨试试将路由器进行硬件超频来使其拥有更强劲的性能。</p>

<p>实现起来也非常简单，不过需要注意的是，超频可能会造成不可恢复的硬件损害，俗称变砖。超频前要三思，也不要妄图过分超频来让路由器硬件性能达到其不可能达到的等级。</p>

<p>要超频需要先登入路由器命令行。推荐使用SSH。Windows下使用puttty等你熟悉的SSH工具，macOS则直接用终端即可。</p>

<p>首先梅林默认是不开启SSH的。需要进入路由器管理界面——系统管理——SSH Daemon来开启。
设置如下：</p>

<p><img src="../_site/../img/merlin-ssh.jpg" style="margin-bottom:15px;" alt="merlin ssh" width="800" /></p>

<p>其中选项都非常清楚明白，按照个人所需设置即可。SSH key 可以让你登录的时候不用输入密码。也就是你登录路由器管理页面设置的密码。</p>

<p>然后在putty或者终端里输入如下命令来登入路由器命令行。命令里的<code class="language-plaintext highlighter-rouge">用户名</code>是你在浏览器中登录路由器管理页面的用户名。</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ssh 用户名@192.168.50.1
</code></pre></div></div>
<p>一般梅林的默认路由器ip有两个，<code class="language-plaintext highlighter-rouge">192.168.2.1</code>或者<code class="language-plaintext highlighter-rouge">192.168.50.1</code>。根据你自己路由器的ip来更改以上命令登入。</p>

<p>如果你没设置SSH key的话，接下来需要输入密码了。</p>

<p>密码正确就进入路由器命令行了, 你会看到类似以下文字：</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ASUSWRT-Merlin [路由器型号] [梅林版本] Tue Sep 25 12:04:55 UTC 2018
[用户名]@[路由器型号]:/tmp/home/root#
</code></pre></div></div>
<p>其中没有中文字的，这里只是说明这里字符代表的意思，你应该能看到你自己路由器的型号、版本、用户名等信息。</p>

<p>接下来运行以下命令:</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>nvram set clkfreq=1000,800
</code></pre></div></div>
<p>这里的1000是设置CPU频率，800是设置内存频率（800相当于1600）。不要改太大。一般建议CPU频率设置数值为默认频率加200就比较安全。性能也能得到较好提升。否则变砖甚至烧机得不偿失。</p>

<p>然后运行以下命令来提交更改。</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>nvram commit
</code></pre></div></div>

<p>最后运行<code class="language-plaintext highlighter-rouge">reboot</code>来重启路由器。</p>

<p>如果没什么问题，重启完成后路由器就超频成功了。</p>

<p>有时候会遇到路由器亮两个红灯无法正常启动的情况，不要慌，这不是变砖，只是启动失败。刷了梅林之后会经常遇到启动失败的问题。这时候只要给路由器断电，等几秒，再次按电源键启动即可。如果还是启动不了就再重启一次。多试几次一般都能成功启动。</p>

<p>实在不行只能重置。拿笔戳重置按钮30秒，然后继续按着重置按钮不动，重置电源启动30秒，再关闭电源30秒，最后再启动。传说中的<code class="language-plaintext highlighter-rouge">30-30-30</code>大法，重置成功就代表没变砖。</p>

      </p>
    </div>
    

    

</section>

<section class="post">
  <header class="post-header">
    <p class="post-meta">
      <span class="post-date">
        20 MAY 2020
      </span>
      
      •
      
        <a class="post-cat" href="https://momane.com/categories/#programming">programming</a>
        
      
      
    </p>
    <h2>
      <a href="https://momane.com/use-husky-to-manage-git-hooks" class="post-title" title="Use Husky to manage git hooks">Use Husky to manage git hooks</a>
      
    </h2>

    

    </header>

    
    <div class="post-description">
      <p>
        <p><a href="https://git-scm.com/book/en/v2/Customizing-Git-Git-Hooks">Git hooks</a> is a powerful tool to make your life easier.</p>

<p>It fires off custom scripts when certain important actions occur. one common scene like:  you want to lint your code every time when you commit
 changes, so that your code has a good style and following your team’s code specification. Or you want to run test before pushing your code/</p>

<blockquote>
  <p>Like many other Version Control Systems, Git has a way to fire off custom scripts when certain important actions occur. There are two groups of these hooks: client-side and server-side. Client-side hooks are triggered by operations such as committing and merging, while server-side hooks run on network operations such as receiving pushed commits. You can use these hooks for all sorts of reasons.</p>
</blockquote>

<p>With git hooks, you can make these actions automatically.</p>

<p>While <a href="https://www.npmjs.com/package/husky"><strong>husky</strong></a> is a tool to make Git hooks easier to use. To use it is very easy</p>

<p>First you install it as a development dependency with npm:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>npm <span class="nb">install </span>husky <span class="nt">--save-dev</span>
</code></pre></div></div>

<p>OR <strong>yarn</strong>:</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>yarn add husky <span class="nt">-D</span>
</code></pre></div></div>

<p>Then in your <code class="language-plaintext highlighter-rouge">package.json</code> , add:</p>
<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"husky"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nl">"hooks"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"pre-commit"</span><span class="p">:</span><span class="w"> </span><span class="s2">"yarn lint"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"pre-push"</span><span class="p">:</span><span class="w"> </span><span class="s2">"yarn test"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"..."</span><span class="p">:</span><span class="w"> </span><span class="s2">"..."</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<p>In the example, we added 2 hooks, <code class="language-plaintext highlighter-rouge">pre-commit</code> and <code class="language-plaintext highlighter-rouge">pre-push</code>, they are meant what they named.</p>

<ul>
  <li><strong>pre-commit</strong> means, every time you run <code class="language-plaintext highlighter-rouge">git commit</code>, it will run <code class="language-plaintext highlighter-rouge">yarn lint</code> first, and commit the code if <code class="language-plaintext highlighter-rouge">yarn lint</code> passes without error.</li>
  <li><strong>pre-push</strong> run command <code class="language-plaintext highlighter-rouge">yarn test</code> when you run <code class="language-plaintext highlighter-rouge">git push</code></li>
  <li><code class="language-plaintext highlighter-rouge">yarn lint</code> and <code class="language-plaintext highlighter-rouge">yarn test</code> are commands that you define in your <code class="language-plaintext highlighter-rouge">scripts</code> in package.json. normally those commands that you runs manually, like
<code class="language-plaintext highlighter-rouge">yarn start</code> or <code class="language-plaintext highlighter-rouge">yarn dev</code>, etc. you can add any command you want and run the, in the hooks.</li>
</ul>

<p>Pretty straight forward and easy :)</p>


      </p>
    </div>
    

    

</section>

<section class="post">
  <header class="post-header">
    <p class="post-meta">
      <span class="post-date">
        7 APR 2020
      </span>
      
      •
      
        <a class="post-cat" href="https://momane.com/categories/#programming">programming</a>
        
      
      
    </p>
    <h2>
      <a href="https://momane.com/use-document-execcommand-to-set-value" class="post-title" title="Use document.execCommand to set value in editable field and trigger events">Use document.execCommand to set value in editable field and trigger events</a>
      
    </h2>

    

    </header>

    
    <div class="post-description">
      <p>
        <p><strong>NOTE: This <a href="https://developer.mozilla.org/en-US/docs/Web/API/Document/execCommand"><code class="language-plaintext highlighter-rouge">document.execCommand</code></a> api has been marked as <code class="language-plaintext highlighter-rouge">Obsolete</code>. However, given the situation that new API is still under construction, so it’s still safe to use it for now and maybe for next few years.</strong></p>

<p>To set value in editable filed like input, textarea with javascript is a common requirement in browser extension or other script development. 
Normally you just need to do something like <code class="language-plaintext highlighter-rouge">document.querySelector('input').value="text you want to set"</code> to get the job done easily and quickly.</p>

<p>But life is not always so easy. Actually most of the time you need to do more in browser extension development. The input fileds always bond many events like <code class="language-plaintext highlighter-rouge">beforeinput</code>, <code class="language-plaintext highlighter-rouge">input</code>,<code class="language-plaintext highlighter-rouge">change</code>, or even <code class="language-plaintext highlighter-rouge">focus</code>, <code class="language-plaintext highlighter-rouge">active</code>. If you just set the <code class="language-plaintext highlighter-rouge">value</code> by javascript, you will also need to trigger these events manually in next steps.</p>

<p>And before that you will need to find out what events you need to trigger. It gonna take you some time.</p>

<p>With this <code class="language-plaintext highlighter-rouge">document.execCoomand</code>, you can do it easily.</p>

<p>The syntax is like this:</p>
<blockquote>
  <p>document.execCommand(aCommandName, aShowDefaultUI, aValueArgument)</p>
</blockquote>

<p>There is a <strong>insertText</strong> you can use to set value.</p>
<blockquote>
  <p>Inserts the given plain text at the insertion point (deletes selection).</p>
</blockquote>

<p>so to insert text in to a field, you just, focus the field -&gt; select the field -&gt; execute the command, like so:</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">const</span> <span class="nx">element</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="dl">"</span><span class="s2">#target</span><span class="dl">"</span><span class="p">)</span>
<span class="nx">element</span><span class="p">.</span><span class="nx">focus</span><span class="p">()</span>
<span class="nx">element</span><span class="p">.</span><span class="nx">select</span><span class="p">()</span>
<span class="nb">document</span><span class="p">.</span><span class="nx">execCommand</span><span class="p">(</span><span class="dl">"</span><span class="s2">insertText</span><span class="dl">"</span><span class="p">,</span> <span class="kc">false</span><span class="p">,</span> <span class="dl">"</span><span class="s2">text you want to set</span><span class="dl">"</span><span class="p">)</span>
</code></pre></div></div>

<p>The best of this API is that, <strong>it imitates user input event, make it like human being activity, trigger all bond events on the filed</strong>.</p>

<p>This API is very powerful, there are a bunch of commands you can use to make you life easier.</p>

<p>You can read it’s doc on MDN to get more details: https://developer.mozilla.org/en-US/docs/Web/API/Document/execCommand</p>

      </p>
    </div>
    

    

</section>

<section class="post">
  <header class="post-header">
    <p class="post-meta">
      <span class="post-date">
        12 MAR 2020
      </span>
      
      •
      
        <a class="post-cat" href="https://momane.com/categories/#programming">programming</a>
        
      
      
    </p>
    <h2>
      <a href="https://momane.com/how-to-trigger-click-event-in-gmail" class="post-title" title="How to trigger click event in Gmail">How to trigger click event in Gmail</a>
      
    </h2>

    

    </header>

    
    <div class="post-description">
      <p>
        <p>If you want to hack Gmail UI, to build web extension or any other similar tool that works on top of Gmail, 
you always want or need to trigger some DOM events in Gmail UI, like you want to click on some buttons/icons,
to send out email, to make the compose window pop out, etc.</p>

<p>You can’t do it by simply use <code class="language-plaintext highlighter-rouge">click</code> function, either by Vanilla JS or jQuery, either <code class="language-plaintext highlighter-rouge">click</code> or <code class="language-plaintext highlighter-rouge">trigger</code> function can not
achieve your goal.</p>

<p>You need to do this by using  <a href="https://developer.mozilla.org/en-US/docs/Web/API/Document/createEvent"><code class="language-plaintext highlighter-rouge">Document.createEvent()</code></a>.</p>

<p>Take <code class="language-plaintext highlighter-rouge">click</code> for example, you want to click an <code class="language-plaintext highlighter-rouge">icon</code>:</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="kd">const</span> <span class="nx">mouseDown</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createEvent</span><span class="p">(</span><span class="dl">'</span><span class="s1">MouseEvents</span><span class="dl">'</span><span class="p">);</span>
  <span class="nx">mouseDown</span><span class="p">.</span><span class="nx">initEvent</span><span class="p">(</span><span class="dl">'</span><span class="s1">mousedown</span><span class="dl">'</span><span class="p">,</span> <span class="kc">true</span><span class="p">,</span> <span class="kc">false</span><span class="p">);</span>
  <span class="nx">icon</span><span class="p">.</span><span class="nx">dispatchEvent</span><span class="p">(</span><span class="nx">mouseDown</span><span class="p">);</span>

  <span class="kd">const</span> <span class="nx">mouseUp</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createEvent</span><span class="p">(</span><span class="dl">'</span><span class="s1">MouseEvents</span><span class="dl">'</span><span class="p">);</span>
  <span class="nx">mouseUp</span><span class="p">.</span><span class="nx">initEvent</span><span class="p">(</span><span class="dl">'</span><span class="s1">mouseup</span><span class="dl">'</span><span class="p">,</span> <span class="kc">true</span><span class="p">,</span> <span class="kc">false</span><span class="p">);</span>
  <span class="nx">icon</span><span class="p">.</span><span class="nx">dispatchEvent</span><span class="p">(</span><span class="nx">mouseUp</span><span class="p">);</span>
</code></pre></div></div>

<p>You may want to make it as a function so that you can use it click any element.</p>

      </p>
    </div>
    

    

</section>

<section class="post">
  <header class="post-header">
    <p class="post-meta">
      <span class="post-date">
        10 MAR 2020
      </span>
      
      •
      
        <a class="post-cat" href="https://momane.com/categories/#programming">programming</a>
        
      
      
    </p>
    <h2>
      <a href="https://momane.com/boost-your-development-speed-in-china" class="post-title" title="Boost your Frontend development speed in China">Boost your Frontend development speed in China</a>
      
    </h2>

    

    </header>

    
    <div class="post-description">
      <p>
        <p>Waiting for something is wasting time, especially when development, you always need to wait for compiling, wait for install dependencies…</p>

<p>And if you are in China, this waiting time will be much longer because of some well known reason.</p>

<p>Here are some changes that will save you some time in China if you are doing frontend development.</p>

<h2 id="ruby-and-rails">Ruby and Rails</h2>

<p>change your gem source to China mirror, source: https://ruby-china.org/</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>gem <span class="nb">source</span> <span class="nt">-a</span> https://gems.ruby-china.com
</code></pre></div></div>

<h2 id="npm">npm</h2>
<p>change your npm source to China mirror, source , source: https://developer.aliyun.com/mirror/NPM</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>npm config <span class="nb">set </span>registry https://registry.npm.taobao.org
</code></pre></div></div>

<p>or you can also install a <code class="language-plaintext highlighter-rouge">cnpm</code>, use <code class="language-plaintext highlighter-rouge">cnpm</code> rather than <code class="language-plaintext highlighter-rouge">npm</code>, to avoid change the source url permanently.</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>npm <span class="nb">install</span> <span class="nt">-g</span> cnpm <span class="nt">--registry</span><span class="o">=</span>https://registry.npm.taobao.org
</code></pre></div></div>

<h2 id="yarn">yarn</h2>
<p>Same as npm.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>yarn config <span class="nb">set </span>registry https://registry.npm.taobao.org <span class="nt">--global</span>
</code></pre></div></div>
<p>there is no <code class="language-plaintext highlighter-rouge">cyarn</code> though</p>

<h2 id="ubuntu">ubuntu</h2>
<p>change sourcelist, check <a href="/change-ubuntu-18-04-source-to-china-mirror">this post</a></p>

<h2 id="homebrew">homebrew</h2>
<p>change homebrew core source and repo to USTC (University of Science and Technology of China) <a href="https://lug.ustc.edu.cn/wiki/mirrors/help/brew.git">Mirror</a>.</p>

<ul>
  <li>
    <p>change brew.git:</p>

    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code> <span class="nb">cd</span> <span class="s2">"</span><span class="si">$(</span>brew <span class="nt">--repo</span><span class="si">)</span><span class="s2">"</span>
 git remote set-url origin https://mirrors.ustc.edu.cn/brew.git
</code></pre></div>    </div>
  </li>
  <li>
    <p>change homebrew-core.git</p>

    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code> <span class="nb">cd</span> <span class="s2">"</span><span class="si">$(</span>brew <span class="nt">--repo</span><span class="si">)</span><span class="s2">/Library/Taps/homebrew/homebrew-core"</span>
 git remote set-url origin https://mirrors.ustc.edu.cn/homebrew-core.git
</code></pre></div>    </div>
  </li>
  <li>
    <p>change homebrew bottles source</p>

    <p>for <code class="language-plaintext highlighter-rouge">bash</code> user</p>
    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code> <span class="nb">echo</span> <span class="s1">'export HOMEBREW_BOTTLE_DOMAIN=https://mirrors.ustc.edu.cn/homebrew-bottles'</span> <span class="o">&gt;&gt;</span> ~/.bash_profile
 <span class="nb">source</span> ~/.bash_profile
</code></pre></div>    </div>
    <p>for <code class="language-plaintext highlighter-rouge">zsh</code> user</p>
    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code> <span class="nb">echo</span> <span class="s1">'export HOMEBREW_BOTTLE_DOMAIN=https://mirrors.ustc.edu.cn/homebrew-bottles'</span> <span class="o">&gt;&gt;</span> ~/.zshrc
 <span class="nb">source</span> ~/.zshrc
</code></pre></div>    </div>
  </li>
</ul>


      </p>
    </div>
    

    

</section>

<section class="post">
  <header class="post-header">
    <p class="post-meta">
      <span class="post-date">
        27 JAN 2020
      </span>
      
      •
      
        <a class="post-cat" href="https://momane.com/categories/#life">life</a>
        
      
      
    </p>
    <h2>
      <a href="https://momane.com/rip-kobe-bryant" class="post-title" title="RIP, Kobe Bryant">RIP, Kobe Bryant</a>
      
    </h2>

    

    </header>

    
    <div class="post-description">
      <p>
        <p>RIP</p>

<p><img src="https://s3.amazonaws.com/ogden_images/www.adirondackdailyenterprise.com/images/2020/01/26152959/BryantKobe05wiki-563x840.jpg" alt="RIP, Kobe Bryant" title="RIP, Kobe Bryant" /></p>

      </p>
    </div>
    

    

</section>

<section class="post">
  <header class="post-header">
    <p class="post-meta">
      <span class="post-date">
        23 JAN 2020
      </span>
      
      •
      
        <a class="post-cat" href="https://momane.com/categories/#life">life</a>
        
      
      
    </p>
    <h2>
      <a href="https://momane.com/2019-ncov" class="post-title" title="2019 nCoV">2019 nCoV</a>
      
    </h2>

    

    </header>

    
    <div class="post-description">
      <p>
        <p>It’s 23th Jan already.</p>

<p>2019-nCoV virus is raging in China and some other countries, and also lunar new year tomorrow.</p>

<p>Just like 17 years ago, SARS everywhere. Back then I was a senior middle school student. Sat in the classroom every day, the teachers tried sterilization by boiling vinegar in the classroom.</p>

<p>Luckily it’s spring soon, SARS gone quietly just like how it came. Hundreds of people died, lots of them were doctors and nurses. Feel so sad about them.</p>

<p>Then in 2009, there was H1N1. I was at university. I only saw the news on TV and the internet. Weird thing is, in my memory, it was not as bad as in 2003. I was busying getting prepared for job, nothing different. But I just found out today on the internet, about 648 people died in China mainland, while it was 349 in 2003 SARS. Kind of shock news to me.</p>

<p>And now, more than 600 people in China mainland got this virus, 17 of them dead. Heard from some news there would be more soon since Wuhan is a big city and many people who work there will go back to their own town to celebrate the lunar new year.</p>

<p>In the meantime in the US, CDC says about 6600 died because of the flu.</p>

<p>And in Australia, the fire has burnt for months and it’s still burning.</p>

<p>So many disasters this year. I just wish everything will be OK for everyone and no more disaster to every country and every human being.</p>


      </p>
    </div>
    

    

</section>

<section class="post">
  <header class="post-header">
    <p class="post-meta">
      <span class="post-date">
        12 NOV 2019
      </span>
      
      •
      
        <a class="post-cat" href="https://momane.com/categories/#programming">programming</a>
        
      
      
    </p>
    <h2>
      <a href="https://momane.com/how-to-keep-preview-file-in-vscode-quickly" class="post-title" title="how to keep preview file in VS Code quickly">how to keep preview file in VS Code quickly</a>
      
    </h2>

    

    </header>

    
    <div class="post-description">
      <p>
        <p>You are a VS Code master, you barely use mouse when coding.</p>

<p>You want to edit a file A in your project.</p>

<p>You open A via hotkey, CMD+Shif+R (yes, I came from eclipse).</p>

<p>Before you editing A, you want to check some reference in another file B.</p>

<p>You open B with same hotkey, you got your information.</p>

<p>Then you want to go back to A to make your editing.</p>

<p>Where is my file A? That one with 1000 rows of code, it was there just before.</p>

<p>Alright I can just open it again, CMD SHIFT R, yes, it comes back.</p>

<p>WTF, Why is B gone?</p>

<p>This happens a lot before to me, I have to double click the file in the project file list to keep it open.</p>

<p>It’s because VS Code thinks that you just want to <code class="language-plaintext highlighter-rouge">preview</code> the file when you single click the file or open it with hotkey.</p>

<p>But it’s really annoying that you want to open multiple files in editor and keep them open.</p>

<p>So here is a quicky way to do this:</p>

<p>Press a <strong>CMD + S</strong> (Ctrl+S on Windows, that’s hotkey for <code class="language-plaintext highlighter-rouge">save</code> ) once you open the file. You will notice that the file name font in tab becomes regular from italic.</p>


      </p>
    </div>
    

    

</section>

<section class="post">
  <header class="post-header">
    <p class="post-meta">
      <span class="post-date">
        16 AUG 2019
      </span>
      
      •
      
        <a class="post-cat" href="https://momane.com/categories/#system">system</a>
        
      
      
    </p>
    <h2>
      <a href="https://momane.com/change-ubuntu-18-04-source-to-china-mirror" class="post-title" title="Change Ubuntu 18.04 update source to mirror site in China">Change Ubuntu 18.04 update source to mirror site in China</a>
      
    </h2>

    

    </header>

    
    <div class="post-description">
      <p>
        <p>To use ubuntu is not a easy thing, and if you are in China, it’s even more difficult. Once you want to update your ubuntu. you’d find it’s very slow.
Because of some well known reason.</p>

<p>So it’s better to change the update source to some mirror site in China.</p>

<p>Here are several famous mirror sites. What you need todo is pick one from below and edit <code class="language-plaintext highlighter-rouge">etc/apt/sources.list</code>, replace the content in this file.</p>

<p><strong>Better backup you <code class="language-plaintext highlighter-rouge">etc/apt/sources.list</code> before you do this</strong></p>

<h4 id="163-netease">163 (netease)</h4>
<p><em>source:http://mirrors.163.com/</em></p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>deb http://mirrors.163.com/ubuntu/ bionic main restricted universe multiverse
deb http://mirrors.163.com/ubuntu/ bionic-security main restricted universe multiverse
deb http://mirrors.163.com/ubuntu/ bionic-updates main restricted universe multiverse
deb http://mirrors.163.com/ubuntu/ bionic-proposed main restricted universe multiverse
deb http://mirrors.163.com/ubuntu/ bionic-backports main restricted universe multiverse
deb-src http://mirrors.163.com/ubuntu/ bionic main restricted universe multiverse
deb-src http://mirrors.163.com/ubuntu/ bionic-security main restricted universe multiverse
deb-src http://mirrors.163.com/ubuntu/ bionic-updates main restricted universe multiverse
deb-src http://mirrors.163.com/ubuntu/ bionic-proposed main restricted universe multiverse
deb-src http://mirrors.163.com/ubuntu/ bionic-backports main restricted universe multiverse
</code></pre></div></div>

<h4 id="alibaba-aliyun">alibaba (aliyun)</h4>
<p><em>source:https://opsx.alibaba.com/mirror</em></p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>deb http://mirrors.aliyun.com/ubuntu/ bionic main restricted universe multiverse
deb http://mirrors.aliyun.com/ubuntu/ bionic-security main restricted universe multiverse
deb http://mirrors.aliyun.com/ubuntu/ bionic-updates main restricted universe multiverse
deb http://mirrors.aliyun.com/ubuntu/ bionic-proposed main restricted universe multiverse
deb http://mirrors.aliyun.com/ubuntu/ bionic-backports main restricted universe multiverse
deb-src http://mirrors.aliyun.com/ubuntu/ bionic main restricted universe multiverse
deb-src http://mirrors.aliyun.com/ubuntu/ bionic-security main restricted universe multiverse
deb-src http://mirrors.aliyun.com/ubuntu/ bionic-updates main restricted universe multiverse
deb-src http://mirrors.aliyun.com/ubuntu/ bionic-proposed main restricted universe multiverse
deb-src http://mirrors.aliyun.com/ubuntu/ bionic-backports main restricted universe multiverse
</code></pre></div></div>
<p>And here are also two Chinese university mirror, use them only if you are in Chinese university.</p>
<h4 id="tsinghua-university">tsinghua university</h4>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ bionic main restricted universe multiverse
deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ bionic main restricted universe multiverse
deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ bionic-updates main restricted universe multiverse
deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ bionic-updates main restricted universe multiverse
deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ bionic-backports main restricted universe multiverse
deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ bionic-backports main restricted universe multiverse
deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ bionic-security main restricted universe multiverse
deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ bionic-security main restricted universe multiverse
deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ bionic-proposed main restricted universe multiverse
deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ bionic-proposed main restricted universe multiverse
</code></pre></div></div>

<h4 id="ustc-university-of-science-and-technology-of-china">ustc (university of science and technology of China)</h4>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>deb https://mirrors.ustc.edu.cn/ubuntu/ bionic main restricted universe multiverse
deb-src https://mirrors.ustc.edu.cn/ubuntu/ bionic main restricted universe multiverse
deb https://mirrors.ustc.edu.cn/ubuntu/ bionic-updates main restricted universe multiverse
deb-src https://mirrors.ustc.edu.cn/ubuntu/ bionic-updates main restricted universe multiverse
deb https://mirrors.ustc.edu.cn/ubuntu/ bionic-backports main restricted universe multiverse
deb-src https://mirrors.ustc.edu.cn/ubuntu/ bionic-backports main restricted universe multiverse
deb https://mirrors.ustc.edu.cn/ubuntu/ bionic-security main restricted universe multiverse
deb-src https://mirrors.ustc.edu.cn/ubuntu/ bionic-security main restricted universe multiverse
deb https://mirrors.ustc.edu.cn/ubuntu/ bionic-proposed main restricted universe multiverse
deb-src https://mirrors.ustc.edu.cn/ubuntu/ bionic-proposed main restricted universe multiverse
</code></pre></div></div>

<p>Enjoy:)</p>


      </p>
    </div>
    

    

</section>

<section class="post">
  <header class="post-header">
    <p class="post-meta">
      <span class="post-date">
        4 AUG 2019
      </span>
      
      •
      
        <a class="post-cat" href="https://momane.com/categories/#system">system</a>
        
      
      
    </p>
    <h2>
      <a href="https://momane.com/disable-web-search-result-in-windows-search" class="post-title" title="Disable Web Search Result in Windows Search 2019">Disable Web Search Result in Windows Search 2019</a>
      
    </h2>

    

    </header>

    
    <div class="post-description">
      <p>
        <p><strong>TL;DR</strong>: download this <a href="https://github.com/HangYang/disable-windows-web-search">windows reg file</a> and double click to import it.
OR</p>
<ul>
  <li>copy the code from below</li>
  <li>open you favourite text editor, or just use notepad</li>
  <li>paste the code into it</li>
  <li>save the file with <code class="language-plaintext highlighter-rouge">.reg</code> extension</li>
  <li>double click the file</li>
</ul>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Windows Registry Editor Version 5.00

[HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows Search ]
"ConnectedSearchUseWebOverMeteredConnections"=dword:00000000
"AllowCortana"=dword:00000000
"DisableWebSearch "=dword:00000001
"ConnectedSearchUseWeb"=dword:00000000

[HKEY_CURRENT_USER\SOFTWARE\Microsoft\Windows\CurrentVersion\Search]
"CortanaConsent"=dword:00000000
"BingSearchEnabled"=dword:00000000
"AllowSearchToUseLocation"=dword:00000000
</code></pre></div></div>

<p>Windows is promoting it’s <code class="language-plaintext highlighter-rouge">Cortana</code> and Bing search for a long time. One of the most annoying thing is that it’s showing web search content when you search in start menu.</p>

<p>So you press <code class="language-plaintext highlighter-rouge">Windows</code> button, type some keywords, all you want to do is just access your installed app or file quickly, but then you saw some shitty stuff in the result list.</p>

<p>Yes, it’s showing web search content and even some so called <code class="language-plaintext highlighter-rouge">search suggesttion</code>. it’s based on your keywords and some trends on the web, since you are searching how to disable
this, I know that you also think it’s totally garbage.</p>

<p>In the beginning, Windows gave us an option in the search menu to turn this off. But then Windows known that most of the users hated it, so it just removed this option…</p>

<p>I have to use group policy, regeditor to disable it, and have to search for this every time when it updates.</p>

<p>To do it step by step is a bit complicated and it’s totally a waste of time. So I just create this reg file so that anyone who want to do this can do it by one click.</p>

<p>Comment for these reg code in case someone doubt it:</p>

<hr />

<p><code class="language-plaintext highlighter-rouge">"ConnectedSearchUseWebOverMeteredConnections"=dword:00000000 </code> // _disable web search use mobile connection</p>

<p><code class="language-plaintext highlighter-rouge">"AllowCortana"=dword:00000000</code>// disable Cortana</p>

<p><code class="language-plaintext highlighter-rouge">"DisableWebSearch "=dword:00000001</code> // disable web search</p>

<p><code class="language-plaintext highlighter-rouge">"ConnectedSearchUseWeb"=dword:00000000</code> // disabled web searech connection</p>

<p><code class="language-plaintext highlighter-rouge">"CortanaConsent"=dword:00000000</code> // disable Cortana</p>

<p><code class="language-plaintext highlighter-rouge">"BingSearchEnabled"=dword:00000000</code> // disable bing search in start menu</p>

<p><code class="language-plaintext highlighter-rouge">"AllowSearchToUseLocation"=dword:00000000</code> // disable search feature access your location</p>

<hr />
<p>Enjoy :)</p>

      </p>
    </div>
    

    

</section>

<section class="post">
  <header class="post-header">
    <p class="post-meta">
      <span class="post-date">
        21 MAY 2019
      </span>
      
      •
      
        <a class="post-cat" href="https://momane.com/categories/#database">database</a>
        
        <span>/</span>
        
      
        <a class="post-cat" href="https://momane.com/categories/#programming">programming</a>
        
      
      
    </p>
    <h2>
      <a href="https://momane.com/mysql-how-to-sort-number-in-string-format" class="post-title" title="MySQL: Sort Number in String Format">MySQL: Sort Number in String Format</a>
      
    </h2>

    

    </header>

    
    <div class="post-description">
      <p>
        <p>TL;DR: use <code class="language-plaintext highlighter-rouge">key_name</code> <code class="language-plaintext highlighter-rouge">*</code> <code class="language-plaintext highlighter-rouge">1</code>; like</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code> select id, name, age from users order by salary * 1
</code></pre></div></div>

<p>Well, it’s better to store number data in number format in the database. But there is always accident, sometimes you or
your colleague just stored some number into database with string format, of cause with some reason.</p>

<p>And one day you need to get data from that table and sort the result by that string-number column. Then you found something 
is not right.</p>

<p>If you run command like this:</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>select "1000" &gt; "2"
</code></pre></div></div>
<p>you will find that the result is <em>0</em>. it means,
<strong>100 &lt; 2</strong>. that’s because mysql just compare these 2 values in as string. thus <strong>2 &gt; 1</strong>.</p>

<p>There are several work around to make this works, like  use <a href="https://dev.mysql.com/doc/refman/8.0/en/mathematical-functions.html#function_conv">conv()</a>.
So write your sql like this:</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>select * from users order by conv(`salary`, 10, 10)
</code></pre></div></div>
<p><code class="language-plaintext highlighter-rouge">conv(original_value, from_base, to_base)</code> is a mysql function, to convert a value from a base to another base, like you can also 
convert a numeric base system 2 to numeric base system 10.</p>

<p>But there is another shorter and cooler way to do this. that’s mul the value by 1. Like so:</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>select * from users order by salary * 1
</code></pre></div></div>
<p>Work like a charm.</p>

<p>Need to notice that if the value is too large, the result will be in <em>Scientific notation</em> like <code class="language-plaintext highlighter-rouge">1e17</code>.</p>

<p>-EOF-</p>

      </p>
    </div>
    

    

</section>

<section class="post">
  <header class="post-header">
    <p class="post-meta">
      <span class="post-date">
        12 FEB 2019
      </span>
      
      •
      
        <a class="post-cat" href="https://momane.com/categories/#chrome">chrome</a>
        
      
      
    </p>
    <h2>
      <a href="https://momane.com/chrome-team-just-released-several-new-official-theme/" class="post-title" title="Chrome team just released several new official themes">Chrome team just released several new official themes</a>
      
    </h2>

    

    </header>

    
    <div class="post-description">
      <p>
        <p><img class="alignnone size-large wp-image-93" src="/assets/Screen-Shot-2019-02-13-at-13.37.13-1024x879.png" alt="" width="600" height="515" /></p>
<p>I never use Chrome theme before, not a fan of customized theme because most of them are too stylish for me.</p>
<p>But Chrome team just released sever official themes days ago, they are clean and fresh, most of them seem for programmers. Like <code>Oceanic</code>, <code>High Contrast Colorful.</code></p>
<p>You can get them from here:&nbsp;<a href="https://chrome.google.com/webstore/category/collection/chrome_themes" target="_blank" rel="noopener"> <code class="EnlighterJSRAW" data-enlighter-language="html"> https://chrome.google.com/webstore/category/collection/chrome_themes</code></a></p>

      </p>
    </div>
    

    

</section>

<section class="post">
  <header class="post-header">
    <p class="post-meta">
      <span class="post-date">
        12 FEB 2019
      </span>
      
      •
      
        <a class="post-cat" href="https://momane.com/categories/#tips">tips</a>
        
      
      
    </p>
    <h2>
      <a href="https://momane.com/how-to-block-https-websites-on-router-with-merlin/" class="post-title" title="How to block HTTPS websites on Router with Merlin">How to block HTTPS websites on Router with Merlin</a>
      
    </h2>

    

    </header>

    
    <div class="post-description">
      <p>
        <p><strong>Merlin</strong> is a very powerful Router OS.</p>
<p>The best feature I like is its plugin system. there you can install many third-party apps like Adblock, web shell, AppleDNS. Most of the great apps are already in its built-in<code class="EnlighterJSRAW" data-enlighter-language="generic">software center</code> you can just install them with 1 click.</p>
<p><img class="alignnone size-large wp-image-82" src="/assets/Screen-Shot-2019-02-12-at-21.16.25-1024x934.png" alt="" width="600" height="547" /></p>
<p>It also has a `Firewall`,&nbsp; here you can add some rules to let the router block some URL or hosts or even IP that you don't want the users access.&nbsp;&nbsp;</p>
<p><img class="alignnone size-large wp-image-83" src="/assets/Screen-Shot-2019-02-12-at-21.20.23-1024x611.png" alt="" width="600" height="358" /></p>
<p>But as it says, it has some limitations:</p>
<ul>
<li>it can not block webpage with <a href="https://en.wikipedia.org/wiki/HTTP_compression">HTTP compression&nbsp;</a></li>
<li>it can not block webpage with HTTPS&nbsp;</li>
</ul>
<p>So basically, since almost all websites are with HTTPS now, this Firewall has actually been useless now.</p>
<p>Of cause, since it's a mini Linux system, you can log in to it in shell and edit&nbsp; <code>hosts</code>, but it's not that convenient&nbsp;to do things with the shell.&nbsp;</p>
<p>Here is a killer app, it's been taken down because of Chinese policy, it's called <code>shad0w20cks</code>(you know it).&nbsp;</p>
<p>In it's <code>DNS Settings</code>, there is a textarea called <code>customize dnsma</code>you can just add your hosts like rules in it. like if you want to block baidu.com and weibo.com:</p>
<p><code>address=/baidu.com/127.0.0.1</code></p>
<p><code>address=/weibo.com/127.0.0.1</code></p>
<p>And then save.</p>
<p><img class="alignnone size-full wp-image-84" src="/assets/Screen-Shot-2019-02-12-at-22.05.52.png" alt="" width="699" height="389" /></p>
<p>works like a charm :D</p>
<p>End.</p></p>
<p><!-- wp:paragraph --></p>
<p><!-- /wp:paragraph --></p>

      </p>
    </div>
    

    

</section>

<section class="post">
  <header class="post-header">
    <p class="post-meta">
      <span class="post-date">
        6 FEB 2019
      </span>
      
      •
      
        <a class="post-cat" href="https://momane.com/categories/#programming">programming</a>
        
        <span>/</span>
        
      
        <a class="post-cat" href="https://momane.com/categories/#vscode">vscode</a>
        
      
      
    </p>
    <h2>
      <a href="https://momane.com/how-to-remove-experimentaldecorators-warning-in-vscode/" class="post-title" title="How to remove experimentalDecorators warning in VSCode">How to remove experimentalDecorators warning in VSCode</a>
      
    </h2>

    

    </header>

    
    <div class="post-description">
      <p>
        <p><!-- wp:heading {"level":3} --></p>
<h3>Problem</h3>
<p><!-- /wp:heading --></p>
<p><!-- wp:paragraph --></p>
<p>Working on a Vue project with VSCode as code editor. Using typescript in the Vue component. </p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>While VSCode keeps warning this message on the declaration of Component class name. Which is very annoying.</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p><strong>Experimental support for decorators is a feature that is subject to change in a future release. Set the ‘experimentalDecorators’ option to remove this warning.</strong></p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:image {"id":65} --></p>
<figure class="wp-block-image"><img src="/assets/Screen-Shot-2019-02-07-at-1.35.18-PM.png?fit=600%2C138&amp;ssl=1" alt="" class="wp-image-65" /></figure>
<p><!-- /wp:image --></p>
<p><!-- wp:paragraph --></p>
<p>Tried to search a bit, in the VSCode github, they tell you to set <code>experimentalDecorators</code> to true in VSCode settings, and restart, however it's not working.</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:heading {"level":3} --></p>
<h3>Solution</h3>
<p><!-- /wp:heading --></p>
<p><!-- wp:paragraph --></p>
<p>you need to modify the typescript configuration. In <code>tsconfig.json</code> file (if you don't have one, create it in your project's root folder). Add this:</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:enlighter/codeblock {"language":"json"} --></p>
<pre class="EnlighterJSRAW" data-enlighter-language="json" data-enlighter-theme="" data-enlighter-highlight="" data-enlighter-linenumbers="" data-enlighter-lineoffset="" data-enlighter-title="" data-enlighter-group="">{
    "compilerOptions": {
        "experimentalDecorators": true,
        "allowJs": true
    }
}</pre>
<p><!-- /wp:enlighter/codeblock --></p>
<p><!-- wp:paragraph --></p>
<p>Both <code>experimentalDecorators<code> </code></code> and <code>allowJs</code>  needs to be set to  <code>true</code></p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>And then restart VSCode. </p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>Done.</p>
<p><!-- /wp:paragraph --></p>

      </p>
    </div>
    

    

</section>

<section class="post">
  <header class="post-header">
    <p class="post-meta">
      <span class="post-date">
        16 JAN 2019
      </span>
      
      •
      
        <a class="post-cat" href="https://momane.com/categories/#bash">bash</a>
        
        <span>/</span>
        
      
        <a class="post-cat" href="https://momane.com/categories/#programming">programming</a>
        
      
      
    </p>
    <h2>
      <a href="https://momane.com/zsh-%e4%b8%bb%e9%a2%98-powerlevel9k-%e5%ae%89%e8%a3%85%e9%85%8d%e7%bd%ae%e8%ae%b0%e5%bd%95/" class="post-title" title="zsh 主题 powerlevel9k 安装配置记录">zsh 主题 powerlevel9k 安装配置记录</a>
      
    </h2>

    

    </header>

    
    <div class="post-description">
      <p>
        <p><!-- wp:image {"id":48} --></p>
<figure class="wp-block-image"><img src="/assets/Screen-Shot-2019-01-16-at-9.33.57-PM-1024x391.png" alt="" class="wp-image-48" /><br />
<figcaption>zsh with powerlevel9k theme</figcaption>
</figure>
<p><!-- /wp:image --></p>
<p><!-- wp:heading {"level":3} --></p>
<h3>安装：</h3>
<p><!-- /wp:heading --></p>
<p><!-- wp:code --></p>
<pre class="wp-block-code"><code>git clone https://github.com/bhilburn/powerlevel9k.git ~/.oh-my-zsh/custom/themes/powerlevel9k</code></pre>
<p><!-- /wp:code --></p>
<p><!-- wp:heading {"level":3} --></p>
<h3>启用和配置</h3>
<p><!-- /wp:heading --></p>
<p><!-- wp:paragraph --></p>
<p>编辑 `~/.zshrc`</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:list --></p>
<ul>
<li>启用</li>
</ul>
<p><!-- /wp:list --></p>
<p><!-- wp:code --></p>
<pre class="wp-block-code"><code>ZSH_THEME="powerlevel9k/powerlevel9k"</code></pre>
<p><!-- /wp:code --></p>
<p><!-- wp:list --></p>
<ul>
<li>改变配置</li>
</ul>
<p><!-- /wp:list --></p>
<p><!-- wp:code --></p>
<pre class="wp-block-code"><code>POWERLEVEL9K_LEFT_PROMPT_ELEMENTS=(dir vcs) #左侧显示全路径和Git状态</code></pre>
<p><!-- /wp:code --></p>
<p><!-- wp:code --></p>
<pre class="wp-block-code"><code>POWERLEVEL9K_RIGHT_PROMPT_ELEMENTS=(time ram) #右侧显示时间和内存</code></pre>
<p><!-- /wp:code --></p>
<p><!-- wp:paragraph --></p>
<p>我本人需要的就这些，显示结果如题图。更多详细配置见：<a href="https://github.com/bhilburn/powerlevel9k">https://github.com/bhilburn/powerlevel9k</a></p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>遇到乱码在iterm2的配置里面修改字体即可。</p>
<p><!-- /wp:paragraph --></p>

      </p>
    </div>
    

    

</section>

<section class="post">
  <header class="post-header">
    <p class="post-meta">
      <span class="post-date">
        15 JAN 2019
      </span>
      
      •
      
        <a class="post-cat" href="https://momane.com/categories/#git">git</a>
        
        <span>/</span>
        
      
        <a class="post-cat" href="https://momane.com/categories/#programming">programming</a>
        
      
      
    </p>
    <h2>
      <a href="https://momane.com/github%e4%b8%ad%e5%9b%bd%e5%8a%a0%e9%80%9fhosts%e5%88%97%e8%a1%a8/" class="post-title" title="Github中国加速hosts列表">Github中国加速hosts列表</a>
      
    </h2>

    

    </header>

    
    <div class="post-description">
      <p>
        <p><!-- wp:paragraph --></p>
<p>因为众所周知的原因，github对很多中国用户来说有些慢。特别在clone的时候。</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>可以通过修改hosts来解决。最新的hosts列表如下：</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:code --></p>
<pre class="wp-block-code"><code># GitHub Start  updated 15-1-2019
192.30.253.112 github.com
192.30.253.118 gist.github.com
151.101.112.133 assets-cdn.github.com
151.101.184.133 raw.githubusercontent.com
151.101.112.133 gist.githubusercontent.com
151.101.184.133 cloud.githubusercontent.com
151.101.112.133 camo.githubusercontent.com
151.101.112.133 avatars0.githubusercontent.com
151.101.112.133 avatars1.githubusercontent.com
151.101.184.133 avatars2.githubusercontent.com
151.101.12.133 avatars3.githubusercontent.com
151.101.12.133 avatars4.githubusercontent.com
151.101.184.133 avatars5.githubusercontent.com
151.101.184.133 avatars6.githubusercontent.com
151.101.184.133 avatars7.githubusercontent.com
151.101.12.133 avatars8.githubusercontent.com
# GitHub End</code></pre>
<p><!-- /wp:code --></p>

      </p>
    </div>
    

    

</section>

<section class="post">
  <header class="post-header">
    <p class="post-meta">
      <span class="post-date">
        1 JAN 2019
      </span>
      
      •
      
        <a class="post-cat" href="https://momane.com/categories/#programming">programming</a>
        
      
      
    </p>
    <h2>
      <a href="https://momane.com/iterm2-zsh-oh-my-zsh-%e5%ae%89%e8%a3%85%e5%92%8c%e9%85%8d%e7%bd%ae/" class="post-title" title="iTerm2 + zsh + oh my zsh 安装和配置">iTerm2 + zsh + oh my zsh 安装和配置</a>
      
    </h2>

    

    </header>

    
    <div class="post-description">
      <p>
        <p><!-- wp:image --></p>
<figure class="wp-block-image"><img src="/assets/1*QCDLBTPMt3S7G0JOQbD68A.png" alt="" /><br />
<figcaption>https://cdn-images-1.medium.com/max/1600/1*QCDLBTPMt3S7G0JOQbD68A.png</figcaption>
</figure>
<p><!-- /wp:image --></p>
<p><!-- wp:paragraph --></p>
<p>OSX的默认终端terminal功能比较基础，对于普通用户来说不是非常友好，界面也丑丑的。以上是使用iterm2 + <g class="gr_ gr_18 gr-alert gr_spell gr_inline_cards gr_run_anim ContextualSpelling" id="18" data-gr-id="18">zsh</g> + oh my <g class="gr_ gr_34 gr-alert gr_spell gr_inline_cards gr_run_anim ContextualSpelling" id="34" data-gr-id="34">zsh</g> 之后的效果。</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>除了界面很好看而外，还能实现诸如显示当前路径、系统资源占用、git状态等信息。且拥有丰富的可定制化选项，让你可以打造自己的终端。</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>接下来就来一步步定制自己的终端吧。</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:heading {"level":3} --></p>
<h3>安装 Homebrew</h3>
<p><!-- /wp:heading --></p>
<p><!-- wp:paragraph --></p>
<p>打开终端，粘贴如下代码， 这将在你的机器上安装Homebrew，这是一个包管理工具。类似ubuntu里面的 <code>apt</code>.</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:code --></p>
<pre class="wp-block-code"><code>/usr/bin/ruby -e "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install)"
</code></pre>
<p><!-- /wp:code --></p>
<p><!-- wp:heading {"level":3} --></p>
<h3>安装 iTerm2 </h3>
<p><!-- /wp:heading --></p>
<p><!-- wp:paragraph --></p>
<p>这是用来替代terminal的工具，既可以去官网下载：https://www.iterm2.com/downloads.html</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>也可以利用上面安装好的 Homebrew 直接安装：</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:code --></p>
<pre class="wp-block-code"><code>brew cask install iterm2</code></pre>
<p><!-- /wp:code --></p>
<p><!-- wp:heading {"level":3} --></p>
<h3>安装 zsh</h3>
<p><!-- /wp:heading --></p>
<p><!-- wp:paragraph --></p>
<p>还是直接用 homebrew 来安装：</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:code --></p>
<pre class="wp-block-code"><code>brew install zsh</code></pre>
<p><!-- /wp:code --></p>
<p><!-- wp:heading {"level":3} --></p>
<h3>安装 oh-my-zsh</h3>
<p><!-- /wp:heading --></p>
<p><!-- wp:paragraph --></p>
<p>如果不安装 oh-my-zsh的话，zsh会比较难用。OMZ 是一个开源的 zsh 配置管理工具，拥有很多丰富的功能、扩展和皮肤来让定制你的zsh。安装代码如下</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:code --></p>
<pre class="wp-block-code"><code>sh -c "$(curl -fsSL https://raw.githubusercontent.com/robbyrussell/oh-my-zsh/master/tools/install.sh)"</code></pre>
<p><!-- /wp:code --></p>
<p><!-- wp:heading {"level":3} --></p>
<h3>自定义皮肤：</h3>
<p><!-- /wp:heading --></p>
<p><!-- wp:paragraph --></p>
<p>网上有很多的自定义皮肤可以供下载使用。个人比较喜欢现在比较流行的 Material 风格，无论是 vscode 还是其他编辑器，均有这个风格的皮肤，非常清新。预览图如下：</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:image --></p>
<figure class="wp-block-image"><img src="/assets/1*s6QZBNMEEwBQ5VwMy48Dbw.png" alt="" /><br />
<figcaption>https://github.com/MartinSeeler/iterm2-material-design/blob/master/img/screen-mock-1.jpg</figcaption>
</figure>
<p><!-- /wp:image --></p>
<p><!-- wp:paragraph --></p>
<p>1.下载皮肤，在终端中粘贴以下代码：</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:code --></p>
<pre class="wp-block-code"><code>$ cd Downloads
$ curl -O https://raw.githubusercontent.com/MartinSeeler/iterm2-material-design/master/material-design-colors.itermcolors</code></pre>
<p><!-- /wp:code --></p>
<p><!-- wp:paragraph --></p>
<p>2. 打开 iTerm2， 然后到<code>设置（preferences)</code>—— <code>用户（profiles）</code>—— <code>颜色（colors）</code></p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>3. 点击底部的 <code>预设颜色... （Color Presets...） </code></p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>4. 点击导入，然后找到下载文件夹里面刚才下载的扩展名为<code>itermcolors</code>的文件</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>5. 再从下拉菜单中选择刚导入的皮肤文件。</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:image {"id":32} --></p>
<figure class="wp-block-image"><img src="/assets/Screen-Shot-2019-01-01-at-12.28.22-AM-1024x493.png" alt="" class="wp-image-32" /><br />
<figcaption>加载皮肤配置</figcaption>
</figure>
<p><!-- /wp:image --></p>
<p><!-- wp:heading {"level":3} --></p>
<h3>管理扩展</h3>
<p><!-- /wp:heading --></p>
<p><!-- wp:paragraph --></p>
<p>oh-my-zsh 内绑定了不少扩展，这里是列表：https://github.com/robbyrussell/oh-my-zsh/wiki/Plugins</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>绝大多数的扩展都未默认启用，若你想启用某些扩展，需要修改其配置文件。</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>在 iterm2 中输入以下代码来编辑其配置文件：</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:code --></p>
<pre class="wp-block-code"><code>nano ~/.zshrc</code></pre>
<p><!-- /wp:code --></p>
<p><!-- wp:paragraph --></p>
<p>在文件中找到如下代码：</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:code --></p>
<pre class="wp-block-code"><code># Add wisely, as too many plugins slow down shell startup.
plugins=(
  git
)</code></pre>
<p><!-- /wp:code --></p>
<p><!-- wp:paragraph --></p>
<p>这里就是配置扩展的地方，可以看到其默认启动了git扩展。要添加新扩展只要在括号里加名字即可，要注意的是，扩展越多，终端启动和运行就越慢，所以按需添加，比如我加入python常用工具pip：</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:code --></p>
<pre class="wp-block-code"><code>plugins=(
  git
  pip
)</code></pre>
<p><!-- /wp:code --></p>
<p><!-- wp:paragraph --></p>
<p>这样就差不多配置好了。更多配置见这里：https://github.com/robbyrussell/oh-my-zsh/wiki</p>
<p><!-- /wp:paragraph --></p>

      </p>
    </div>
    

    

</section>

<section class="post">
  <header class="post-header">
    <p class="post-meta">
      <span class="post-date">
        20 DEC 2018
      </span>
      
      •
      
        <a class="post-cat" href="https://momane.com/categories/#git">git</a>
        
        <span>/</span>
        
      
        <a class="post-cat" href="https://momane.com/categories/#programming">programming</a>
        
      
      
    </p>
    <h2>
      <a href="https://momane.com/git-delete-all-local-branches-and-keep-one" class="post-title" title="Git: 删除本地所有分支并保留其中一个">Git: 删除本地所有分支并保留其中一个</a>
      
    </h2>

    

    </header>

    
    <div class="post-description">
      <p>
        <p><!-- wp:paragraph --></p>
<p>本地分支多了想删掉一些。(下面所有的命令中运行时均需要把 <code>BRANCH_NAME</code>  换成自己要操作的分支的名字)</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>常用的命令是</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:code --></p>
<pre class="wp-block-code"><code>git branch -D `BRANCH_NAME`</code></pre>
<p><!-- /wp:code --></p>
<p><!-- wp:paragraph --></p>
<p>可是这样只能一个个删除。批量删除并保留一个分支，比如 <code>master</code>  分支的命令可以用下面这条命令：</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:code --></p>
<pre class="wp-block-code"><code>git branch | grep -v "BRANCH_NAME" | xargs git branch -D </code></pre>
<p><!-- /wp:code --></p>
<p><!-- wp:paragraph --></p>
<p>如果你要经常这么做的话，还可以给这条命令添加个短名：</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:code --></p>
<pre class="wp-block-code"><code>alias gdbm="git branch | grep -v "BRANCH_NAME" | xargs git branch -D"</code></pre>
<p><!-- /wp:code --></p>
<p><!-- wp:paragraph --></p>
<p>如果要保留多个分支，可以在足命令中添加多个分支的名字：<code>master\|develop\|test_branch。</code></p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>上面的命令就变成：</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:code --></p>
<pre class="wp-block-code"><code>git branch | grep -v "master\|develop\|test_branch" | xargs git branch -D </code></pre>
<p><!-- /wp:code --></p>

      </p>
    </div>
    

    

</section>

<section class="post">
  <header class="post-header">
    <p class="post-meta">
      <span class="post-date">
        15 DEC 2018
      </span>
      
    </p>
    <h2>
      <a href="https://momane.com/i-wont-reinstall-my-server-again/" class="post-title" title="I won&#39;t reinstall my server again">I won't reinstall my server again</a>
      
    </h2>

    

    </header>

    
    <div class="post-description">
      <p>
        <p><!-- wp:paragraph --></p>
<p>So I reinstalled my server again.</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>lost all data.</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>won't do this again</p>
<p><!-- /wp:paragraph --></p>

      </p>
    </div>
    

    

</section>


        <footer>
  &copy; 2023 Hank X. Powered by <a href="http://jekyllrb.com/">Jekyll</a>, <a href="http://github.com/renyuanz/leonids/">leonids theme</a> made with <i class="fa fa-heart heart-icon"></i>
</footer>

      </div>
    </div>
  </div>
  
<!-- Asynchronous Google Analytics snippet -->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-49503690-1', 'auto');
  ga('send', 'pageview');
</script>



</body>
</html>
